import{g as oe,s as pe,b as E,a as m,t as A,f as le,c as Z,e as Oe}from"../chunks/disclose-version.DARnoLUY.js";import{i as se}from"../chunks/legacy.uhxq8U6e.js";import{p as de,P as N,af as Y,ag as _e,G as e,a as Se,ah as I,I as X,a4 as qe,f as B,c as u,r as l,s as o,t as x,ai as Te,aj as Re}from"../chunks/utils.DS7Odsae.js";import{i as H}from"../chunks/if.DRdOVeSS.js";import{l as ie,g as xe,T as Ue,o as ye,C as ue,R as ne,s as Le,c as ce,e as Ie,i as Pe,a as be,F as ge,P as he,b as He,d as me}from"../chunks/Filters.Dj2uIHTF.js";import{C as Ke,b as Qe,t as ve,s as $e}from"../chunks/Modal.BNz1O048.js";import{m as Fe,F as we}from"../chunks/FlyingSection._X_2QlY3.js";import{t as De,a as Ge,b as Ee,d as $}from"../chunks/client.A4bxOfeX.js";import{p as W,b as Ce,s as je}from"../chunks/preload-helper.ClI4wH-8.js";import{g as Me}from"../chunks/index.CiEhDQPL.js";const ke=[{cycle_index:0,type:"KAMAS",rarety:null,equipment:null,item:null,amount:1},{cycle_index:1,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:2,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:100},{cycle_index:3,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:80},{cycle_index:4,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:5,type:"KAMAS",rarety:null,equipment:null,item:null,amount:5e3},{cycle_index:6,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:7,type:"EQUIPMENT",rarety:"RARE",equipment:null,item:"RING",amount:20},{cycle_index:8,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2e3},{cycle_index:9,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:10,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:11,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:12,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:13,type:"COMPANION",rarety:"COMMON",equipment:null,item:"COMPANION",amount:10},{cycle_index:14,type:"EQUIPMENT",rarety:"COMMON",equipment:null,item:"ARMBAND",amount:20},{cycle_index:15,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:16,type:"COMPANION",rarety:"KROSMIC",equipment:null,item:"COMPANION",amount:5},{cycle_index:17,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:18,type:"EQUIPMENT",rarety:"KROSMIC",equipment:null,item:"RING",amount:5},{cycle_index:19,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:20,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:21,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:22,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:23,type:"KAMAS",rarety:null,equipment:null,item:null,amount:1e3},{cycle_index:24,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2e3},{cycle_index:25,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:100},{cycle_index:26,type:"WAKFU",rarety:null,equipment:null,item:null,amount:999},{cycle_index:27,type:"EQUIPMENT",rarety:"RARE",equipment:null,item:null,amount:10},{cycle_index:32,type:"GEMS",rarety:null,equipment:null,item:null,amount:150},{cycle_index:41,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:100},{cycle_index:48,type:"COMPANION",rarety:"RARE",equipment:null,item:"COMPANION",amount:10},{cycle_index:49,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:1},{cycle_index:51,type:"EQUIPMENT",rarety:"RARE",equipment:null,item:"RING",amount:20},{cycle_index:52,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:80},{cycle_index:53,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:5},{cycle_index:54,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:55,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:56,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:1},{cycle_index:57,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:58,type:"COMPANION",rarety:"INFINITE",equipment:null,item:"COMPANION",amount:1},{cycle_index:59,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:60,type:"EQUIPMENT",rarety:"KROSMIC",equipment:null,item:"RING",amount:20},{cycle_index:61,type:"KAMAS",rarety:null,equipment:null,item:null,amount:5e3},{cycle_index:62,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:63,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:1},{cycle_index:64,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:65,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:2},{cycle_index:66,type:"GEMS",rarety:null,equipment:null,item:null,amount:200},{cycle_index:67,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:68,type:"KAMAS",rarety:null,equipment:null,item:null,amount:1e3},{cycle_index:69,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:80,type:"WAKFU",rarety:null,equipment:null,item:null,amount:3e3},{cycle_index:81,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:2},{cycle_index:82,type:"EQUIPMENT",rarety:"INFINITE",equipment:null,item:null,amount:1},{cycle_index:93,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:103,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:104,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:105,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:106,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:107,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:5},{cycle_index:130,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:150,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:20},{cycle_index:155,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:156,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:157,type:"EQUIPMENT",rarety:"RARE",equipment:null,item:"RING",amount:20},{cycle_index:158,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:159,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:2},{cycle_index:160,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:161,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:162,type:"EQUIPMENT",rarety:"RARE",equipment:null,item:"RING",amount:20},{cycle_index:163,type:"COMPANION",rarety:"COMMON",equipment:null,item:"COMPANION",amount:20},{cycle_index:164,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:1},{cycle_index:165,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:20},{cycle_index:166,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2e3},{cycle_index:167,type:"EQUIPMENT",rarety:"INFINITE",equipment:null,item:"ARMBAND",amount:5},{cycle_index:168,type:"EQUIPMENT",rarety:"RARE",equipment:null,item:"RING",amount:20},{cycle_index:169,type:"COMPANION",rarety:"COMMON",equipment:null,item:"COMPANION",amount:1},{cycle_index:170,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:100},{cycle_index:171,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:2},{cycle_index:173,type:"COMPANION",rarety:"COMMON",equipment:null,item:"COMPANION",amount:20},{cycle_index:174,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:175,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:100},{cycle_index:176,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:182,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:80},{cycle_index:183,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:184,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:185,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:186,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:187,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:188,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:40},{cycle_index:189,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2e3},{cycle_index:190,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:191,type:"EQUIPMENT",rarety:"COMMON",equipment:null,item:"RING",amount:9},{cycle_index:192,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:100},{cycle_index:193,type:"COMPANION",rarety:"KROSMIC",equipment:null,item:"COMPANION",amount:20},{cycle_index:194,type:"COMPANION",rarety:"INFINITE",equipment:null,item:"COMPANION",amount:5},{cycle_index:195,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:196,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:197,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:1},{cycle_index:198,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:199,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:20},{cycle_index:200,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:2},{cycle_index:201,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:202,type:"KAMAS",rarety:null,equipment:null,item:null,amount:1999},{cycle_index:203,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:20},{cycle_index:204,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:205,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:2},{cycle_index:206,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:207,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:100},{cycle_index:209,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:210,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:211,type:"KAMAS",rarety:null,equipment:null,item:null,amount:1e3},{cycle_index:212,type:"KAMAS",rarety:null,equipment:null,item:null,amount:5e3},{cycle_index:275,type:"EQUIPMENT",rarety:"INFINITE",equipment:null,item:"RING",amount:1},{cycle_index:279,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:333,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:334,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:20},{cycle_index:336,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:339,type:"COMPANION",rarety:"KROSMIC",equipment:null,item:"COMPANION",amount:20},{cycle_index:340,type:"COMPANION",rarety:"INFINITE",equipment:null,item:"COMPANION",amount:5},{cycle_index:354,type:"EQUIPMENT",rarety:"COMMON",equipment:null,item:"RING",amount:1}];var We=A(" <!>",1),Ye=A('<button class="validate material-icon svelte-1df2l99">check_circle</button>'),Be=A('<div class="header svelte-1df2l99"><small><!></small> <small> </small></div> <b><!></b> <!>',1);function Ve(K,y){de(y,!1);const f=pe(),O=()=>Z(Fe,"$momentStore",f),c=()=>Z(Ee,"$_",f),r=I();let t=W(y,"reward",8),_=W(y,"index",8),p=W(y,"currentIndex",24,()=>-1),b=W(y,"personalCalendar",24,()=>[]),T=I(!1),s=I("");const P=ie.subscribe(i=>{N(s,xe(t(),i.filters))});Ce(()=>{P()});async function g(){if(!t())throw new Error("No reward to save");if(!e(r))throw new Error("Cannot save a reward that is not the current day");const i={...t()};i.cycle_index=ye(new Date,ue),i.validated=!0,await Le(Me(ce),i),N(T,!0)}Y(()=>(X(_()),X(p())),()=>{N(r,_()===p())}),Y(()=>(e(r),X(b()),ue),()=>{var i;e(r)&&N(T,((i=b()[ye(new Date,ue)])==null?void 0:i.validated)??!1)}),Y(()=>(X(t()),ie),()=>{N(s,xe(t(),Me(ie).filters))}),_e(),se();var Q=qe(()=>O()().add(_()-p(),"days").format("dddd DD MMMM YYYY"));Ue(K,{get title(){return e(Q)},children:(i,V)=>{Ke(i,je({get classes(){return e(s)},width:"10em",height:"3.5em"},()=>({primary:e(r),outline:e(r)}),{children:(n,ee)=>{var R=Be(),U=B(R),C=u(U),F=u(C);{var w=a=>{var d=le();x(()=>E(d,O()().add(_()-p(),"days").format("DD MMM"))),m(a,d)};H(F,a=>{p()>0&&a(w)})}l(C);var D=o(C,2),v=u(D,!0);l(D),l(U);var q=o(U,2),h=u(q);{var G=a=>{var d=We(),S=B(d);x(()=>E(S,`${t().amount??""}x ${c()(t().type)??""} `));var M=o(S);{var z=k=>{var J=le();x(()=>E(J,c()(t().rarety))),m(k,J)},ae=k=>{var J=Oe(),Ae=B(J);{var fe=re=>{var Ne=le();x(()=>E(Ne,c()(t().equipment))),m(re,Ne)};H(Ae,re=>{(t().type===ne.RUNES||t().type===ne.CHEST)&&re(fe)},!0)}m(k,J)};H(M,k=>{t().type===ne.EQUIPMENT||t().type===ne.COMPANION?k(z):k(ae,!1)})}m(a,d)},L=a=>{var d=le("-");m(a,d)};H(h,a=>{t()?a(G):a(L,!1)})}l(q);var j=o(q,2);{var te=a=>{var d=Ye();d.__click=g,De(3,d,()=>Ge,()=>({easing:Qe,duration:500})),m(a,d)};H(j,a=>{t()&&e(r)&&!e(T)&&a(te)})}x(()=>E(v,_())),m(n,R)},$$slots:{default:!0}}))},$$slots:{default:!0}}),Se()}oe(["click"]);var ze=A('<td class="svelte-1puj17x"><button class="material-icon svelte-1puj17x" disabled>task_alt</button></td>'),Je=(K,y,f)=>y(e(f)),Xe=A('<td class="svelte-1puj17x"><button class="material-icon svelte-1puj17x">radio_button_unchecked</button></td>'),Ze=A('<tr class="svelte-1puj17x"><td class="svelte-1puj17x"> </td><td class="svelte-1puj17x"> </td><!></tr>'),et=A('<section class="svelte-1puj17x"><table><thead class="svelte-1puj17x"><tr class="svelte-1puj17x"><th class="svelte-1puj17x"> </th><th class="svelte-1puj17x"> </th><th class="svelte-1puj17x"></th></tr></thead><tbody></tbody></table></section> <div class="info svelte-1puj17x"> </div>',1);function tt(K,y){de(y,!1);const f=pe(),O=()=>Z(Ee,"$_",f);let c=W(y,"offsetsByScore",8),r=W(y,"currentOffset",12),t=I([]),_=I(0);Y(()=>(e(t),X(c())),()=>{N(t,Object.keys(c()).sort((s,P)=>c()[+P]-c()[+s])),N(_,Object.values(c()).reduce((s,P)=>s+P,0)),console.log(c()),r(e(t)[0])}),_e(),se();var p=Oe(),b=B(p);{var T=s=>{var P=et(),g=B(P),Q=u(g),i=u(Q),V=u(i),n=u(V),ee=u(n,!0);x(()=>E(ee,O()($.CALENDAR_OFFSET_KEY))),l(n);var R=o(n),U=u(R,!0);x(()=>E(U,O()($.CALENDAR_OFFSET_PROBABILITY_KEY))),l(R),Te(),l(V),l(i);var C=o(i);Ie(C,5,()=>e(t),Pe,(D,v)=>{var q=Ze(),h=u(q),G=u(h,!0);l(h);var L=o(h),j=u(L);x(()=>E(j,`${Math.round(c()[e(v)]/e(_)*1e3)/10}%`)),l(L);var te=o(L);{var a=S=>{var M=ze();m(S,M)},d=S=>{var M=Xe(),z=u(M);z.__click=[Je,r,v],l(M),m(S,M)};H(te,S=>{e(v)===r()?S(a):S(d,!1)})}l(q),x(()=>{ve(h,"bold",e(v)===r()),E(G,e(v)),ve(L,"bold",e(v)===r())}),m(D,q)}),l(C),l(Q),l(g);var F=o(g,2),w=u(F,!0);x(()=>E(w,O()($.CALENDAR_OFFSET_INFO))),l(F),m(s,P)};H(b,s=>{Object.keys(c()).length>0&&s(T)})}m(K,p),Se()}oe(["click"]);var lt=(K,y)=>N(y,!0),nt=A('<div class="reward"><!></div>'),ut=A('<div class="body svelte-igihim"><div class="info svelte-igihim"><h2> </h2> <div class="svelte-igihim"> </div></div> <div><button class="profile"> </button></div> <!> <!> <section class="svelte-igihim"></section></div>'),at=A("<!> <!>",1);function St(K,y){de(y,!1);const f=pe(),O=()=>Z(Ee,"$_",f),c=()=>Z(ce,"$currentProfile",f),r=I(),t=I([]);let _=I([]),p=I(-1),b=I(-1),T=I(!1);for(const n of ke)Re(t,e(t)[n.cycle_index]=n);function s(n){return n<0?-1:(ye(new Date,ue)-n+me)%me}const P=ce.subscribe(async n=>{N(_,await be(n))});Ce(()=>{P()}),Y(()=>(e(_),e(t)),()=>{N(r,He(e(_),e(t)))}),Y(()=>(e(b),e(p)),()=>{N(b,s(e(p)));const n=document.querySelector(`#reward-${e(b)}`);n&&n.scrollIntoView({block:"center",behavior:"smooth"})}),_e(),se();var g=at(),Q=B(g);{var i=n=>{he(n,{onclose:()=>N(T,!1)})};H(Q,n=>{e(T)&&n(i)})}var V=o(Q,2);we(V,{children:(n,ee)=>{var R=ut(),U=u(R),C=u(U),F=u(C,!0);x(()=>E(F,O()($.CALENDAR_TITLE))),l(C);var w=o(C,2),D=u(w,!0);x(()=>E(D,O()($.CALENDAR_INFO))),l(w),l(U);var v=o(U,2),q=u(v);q.__click=[lt,T];var h=u(q,!0);x(()=>E(h,c()?`${O()($.PROFILE)} : ${c()}`:O()($.PROFILE_DEFAULT))),l(q),l(v);var G=o(v,2);tt(G,{get offsetsByScore(){return e(r)},get currentOffset(){return e(p)},set currentOffset(a){N(p,a)},$$legacy:!0});var L=o(G,2);ge(L,{});var j=o(L,2);Ie(j,5,()=>({length:me}),Pe,(a,d,S)=>{var M=nt();$e(M,"id",`reward-${S}`);var z=u(M),ae=qe(()=>s(e(p)));Ve(z,{get reward(){return e(t)[S]},index:S,get currentIndex(){return e(ae)},get personalCalendar(){return e(_)}}),l(M),m(a,M)}),l(j),l(R),m(n,R)},$$slots:{default:!0}}),m(K,g),Se()}oe(["click"]);export{St as component};
