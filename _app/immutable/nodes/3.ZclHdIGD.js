import{g as oe,s as se,b as N,a as m,t as P,f as le,c as Z,e as Oe}from"../chunks/disclose-version.DARnoLUY.js";import{i as pe}from"../chunks/legacy.uhxq8U6e.js";import{p as de,P as E,af as B,ag as _e,G as e,a as Se,ah as q,I as X,a4 as Ie,f as W,c as a,r as l,s as o,t as v,ai as Te,aj as Re}from"../chunks/utils.DS7Odsae.js";import{i as $}from"../chunks/if.DRdOVeSS.js";import{l as ie,g as ve,T as Ue,o as ce,C as ae,R as ne,s as be,c as ye,e as qe,i as fe,a as ge,F as he,P as Le,b as $e,d as me}from"../chunks/Filters.Dj2uIHTF.js";import{C as Fe,b as Ke,t as xe,s as we}from"../chunks/Modal.BNz1O048.js";import{m as He,F as Qe}from"../chunks/FlyingSection._X_2QlY3.js";import{t as De,a as je,b as Ne,d as w}from"../chunks/client.A4bxOfeX.js";import{p as Y,b as Ce,s as Ge}from"../chunks/preload-helper.ClI4wH-8.js";import{g as Me}from"../chunks/index.CiEhDQPL.js";const ke=[{cycle_index:0,type:"KAMAS",rarety:null,equipment:null,item:null,amount:1},{cycle_index:1,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:2,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:100},{cycle_index:3,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:80},{cycle_index:4,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:5,type:"KAMAS",rarety:null,equipment:null,item:null,amount:5e3},{cycle_index:6,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:7,type:"EQUIPMENT",rarety:"RARE",equipment:null,item:"RING",amount:20},{cycle_index:8,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2e3},{cycle_index:9,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:10,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:11,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:12,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:13,type:"COMPANION",rarety:"COMMON",equipment:null,item:"COMPANION",amount:10},{cycle_index:14,type:"EQUIPMENT",rarety:"COMMON",equipment:null,item:"ARMBAND",amount:20},{cycle_index:15,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:16,type:"COMPANION",rarety:"KROSMIC",equipment:null,item:"COMPANION",amount:5},{cycle_index:17,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:18,type:"EQUIPMENT",rarety:"KROSMIC",equipment:null,item:"RING",amount:5},{cycle_index:19,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:20,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:21,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:22,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:23,type:"KAMAS",rarety:null,equipment:null,item:null,amount:1e3},{cycle_index:24,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2e3},{cycle_index:25,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:100},{cycle_index:41,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:100},{cycle_index:48,type:"COMPANION",rarety:"RARE",equipment:null,item:"COMPANION",amount:10},{cycle_index:49,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:1},{cycle_index:51,type:"EQUIPMENT",rarety:"RARE",equipment:null,item:"RING",amount:20},{cycle_index:52,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:80},{cycle_index:53,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:5},{cycle_index:54,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:55,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:56,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:1},{cycle_index:57,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:58,type:"COMPANION",rarety:"INFINITE",equipment:null,item:"COMPANION",amount:1},{cycle_index:59,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:60,type:"EQUIPMENT",rarety:"KROSMIC",equipment:null,item:"RING",amount:20},{cycle_index:61,type:"KAMAS",rarety:null,equipment:null,item:null,amount:5e3},{cycle_index:62,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:63,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:1},{cycle_index:64,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:65,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:2},{cycle_index:66,type:"GEMS",rarety:null,equipment:null,item:null,amount:200},{cycle_index:67,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:80,type:"WAKFU",rarety:null,equipment:null,item:null,amount:3e3},{cycle_index:81,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:2},{cycle_index:82,type:"EQUIPMENT",rarety:"INFINITE",equipment:null,item:null,amount:1},{cycle_index:93,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:103,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:104,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:105,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:106,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:107,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:5},{cycle_index:130,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:150,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:20},{cycle_index:155,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:182,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:80},{cycle_index:183,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:184,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:185,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:186,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:187,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:188,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:40},{cycle_index:189,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2e3},{cycle_index:190,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:191,type:"EQUIPMENT",rarety:"COMMON",equipment:null,item:"RING",amount:9},{cycle_index:192,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:100},{cycle_index:193,type:"COMPANION",rarety:"KROSMIC",equipment:null,item:"COMPANION",amount:20},{cycle_index:194,type:"COMPANION",rarety:"INFINITE",equipment:null,item:"COMPANION",amount:5},{cycle_index:195,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:196,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:197,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:1},{cycle_index:198,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:199,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:20},{cycle_index:200,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:2},{cycle_index:202,type:"KAMAS",rarety:null,equipment:null,item:null,amount:1999},{cycle_index:203,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:20},{cycle_index:204,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:205,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:2},{cycle_index:206,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:207,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:100},{cycle_index:209,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:210,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:275,type:"EQUIPMENT",rarety:"INFINITE",equipment:null,item:"RING",amount:1},{cycle_index:279,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:336,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:339,type:"COMPANION",rarety:"KROSMIC",equipment:null,item:"COMPANION",amount:20},{cycle_index:340,type:"COMPANION",rarety:"INFINITE",equipment:null,item:"COMPANION",amount:5},{cycle_index:354,type:"EQUIPMENT",rarety:"COMMON",equipment:null,item:"RING",amount:1}];var Ye=P(" <!>",1),Be=P('<button class="validate material-icon svelte-1df2l99">check_circle</button>'),We=P('<div class="header svelte-1df2l99"><small><!></small> <small> </small></div> <b><!></b> <!>',1);function Ve(F,c){de(c,!1);const A=se(),O=()=>Z(He,"$momentStore",A),y=()=>Z(Ne,"$_",A),u=q();let t=Y(c,"reward",8),_=Y(c,"index",8),s=Y(c,"currentIndex",24,()=>-1),g=Y(c,"personalCalendar",24,()=>[]),T=q(!1),p=q("");const f=ie.subscribe(i=>{E(p,ve(t(),i.filters))});Ce(()=>{f()});async function h(){if(!t())throw new Error("No reward to save");if(!e(u))throw new Error("Cannot save a reward that is not the current day");const i={...t()};i.cycle_index=ce(new Date,ae),i.validated=!0,await be(Me(ye),i),E(T,!0)}B(()=>(X(_()),X(s())),()=>{E(u,_()===s())}),B(()=>(e(u),X(g()),ae),()=>{var i;e(u)&&E(T,((i=g()[ce(new Date,ae)])==null?void 0:i.validated)??!1)}),B(()=>(X(t()),ie),()=>{E(p,ve(t(),Me(ie).filters))}),_e(),pe();var K=Ie(()=>O()().add(_()-s(),"days").format("dddd DD MMMM YYYY"));Ue(F,{get title(){return e(K)},children:(i,V)=>{Fe(i,Ge({get classes(){return e(p)},width:"10em",height:"3.5em"},()=>({primary:e(u),outline:e(u)}),{children:(n,ee)=>{var R=We(),U=W(R),C=a(U),H=a(C);{var Q=r=>{var d=le();v(()=>N(d,O()().add(_()-s(),"days").format("DD MMM"))),m(r,d)};$(H,r=>{s()>0&&r(Q)})}l(C);var D=o(C,2),x=a(D,!0);l(D),l(U);var I=o(U,2),L=a(I);{var j=r=>{var d=Ye(),S=W(d);v(()=>N(S,`${t().amount??""}x ${y()(t().type)??""} `));var M=o(S);{var z=k=>{var J=le();v(()=>N(J,y()(t().rarety))),m(k,J)},re=k=>{var J=Oe(),Pe=W(J);{var Ae=ue=>{var Ee=le();v(()=>N(Ee,y()(t().equipment))),m(ue,Ee)};$(Pe,ue=>{(t().type===ne.RUNES||t().type===ne.CHEST)&&ue(Ae)},!0)}m(k,J)};$(M,k=>{t().type===ne.EQUIPMENT||t().type===ne.COMPANION?k(z):k(re,!1)})}m(r,d)},b=r=>{var d=le("-");m(r,d)};$(L,r=>{t()?r(j):r(b,!1)})}l(I);var G=o(I,2);{var te=r=>{var d=Be();d.__click=h,De(3,d,()=>je,()=>({easing:Ke,duration:500})),m(r,d)};$(G,r=>{t()&&e(u)&&!e(T)&&r(te)})}v(()=>N(x,_())),m(n,R)},$$slots:{default:!0}}))},$$slots:{default:!0}}),Se()}oe(["click"]);var ze=P('<td class="svelte-1puj17x"><button class="material-icon svelte-1puj17x" disabled>task_alt</button></td>'),Je=(F,c,A)=>c(e(A)),Xe=P('<td class="svelte-1puj17x"><button class="material-icon svelte-1puj17x">radio_button_unchecked</button></td>'),Ze=P('<tr class="svelte-1puj17x"><td class="svelte-1puj17x"> </td><td class="svelte-1puj17x"> </td><!></tr>'),et=P('<section class="svelte-1puj17x"><table><thead class="svelte-1puj17x"><tr class="svelte-1puj17x"><th class="svelte-1puj17x"> </th><th class="svelte-1puj17x"> </th><th class="svelte-1puj17x"></th></tr></thead><tbody></tbody></table></section> <div class="info svelte-1puj17x"> </div>',1);function tt(F,c){de(c,!1);const A=se(),O=()=>Z(Ne,"$_",A);let y=Y(c,"offsetsByScore",8),u=Y(c,"currentOffset",12),t=q([]),_=q(0);B(()=>(e(t),X(y())),()=>{E(t,Object.keys(y()).sort((p,f)=>y()[+f]-y()[+p])),E(_,Object.values(y()).reduce((p,f)=>p+f,0)),console.log(y()),u(e(t)[0])}),_e(),pe();var s=Oe(),g=W(s);{var T=p=>{var f=et(),h=W(f),K=a(h),i=a(K),V=a(i),n=a(V),ee=a(n,!0);v(()=>N(ee,O()(w.CALENDAR_OFFSET_KEY))),l(n);var R=o(n),U=a(R,!0);v(()=>N(U,O()(w.CALENDAR_OFFSET_PROBABILITY_KEY))),l(R),Te(),l(V),l(i);var C=o(i);qe(C,5,()=>e(t),fe,(D,x)=>{var I=Ze(),L=a(I),j=a(L,!0);l(L);var b=o(L),G=a(b);v(()=>N(G,`${Math.round(y()[e(x)]/e(_)*1e3)/10}%`)),l(b);var te=o(b);{var r=S=>{var M=ze();m(S,M)},d=S=>{var M=Xe(),z=a(M);z.__click=[Je,u,x],l(M),m(S,M)};$(te,S=>{e(x)===u()?S(r):S(d,!1)})}l(I),v(()=>{xe(L,"bold",e(x)===u()),N(j,e(x)),xe(b,"bold",e(x)===u())}),m(D,I)}),l(C),l(K),l(h);var H=o(h,2),Q=a(H,!0);v(()=>N(Q,O()(w.CALENDAR_OFFSET_INFO))),l(H),m(p,f)};$(g,p=>{Object.keys(y()).length>0&&p(T)})}m(F,s),Se()}oe(["click"]);var lt=(F,c)=>E(c,!0),nt=P('<div class="reward"><!></div>'),at=P('<div class="body svelte-igihim"><div class="info svelte-igihim"><h2> </h2> <div class="svelte-igihim"> </div></div> <div><button class="profile"> </button></div> <!> <!> <section class="svelte-igihim"></section></div>'),rt=P("<!> <!>",1);function St(F,c){de(c,!1);const A=se(),O=()=>Z(Ne,"$_",A),y=()=>Z(ye,"$currentProfile",A),u=q(),t=q([]);let _=q([]),s=q(-1),g=q(-1),T=q(!1);for(const n of ke)Re(t,e(t)[n.cycle_index]=n);function p(n){return n<0?-1:(ce(new Date,ae)-n+me)%me}const f=ye.subscribe(async n=>{E(_,await ge(n))});Ce(()=>{f()}),B(()=>(e(_),e(t)),()=>{E(u,$e(e(_),e(t)))}),B(()=>(e(g),e(s)),()=>{E(g,p(e(s)));const n=document.querySelector(`#reward-${e(g)}`);n&&n.scrollIntoView({block:"center",behavior:"smooth"})}),_e(),pe();var h=rt(),K=W(h);{var i=n=>{Le(n,{onclose:()=>E(T,!1)})};$(K,n=>{e(T)&&n(i)})}var V=o(K,2);Qe(V,{children:(n,ee)=>{var R=at(),U=a(R),C=a(U),H=a(C,!0);v(()=>N(H,O()(w.CALENDAR_TITLE))),l(C);var Q=o(C,2),D=a(Q,!0);v(()=>N(D,O()(w.CALENDAR_INFO))),l(Q),l(U);var x=o(U,2),I=a(x);I.__click=[lt,T];var L=a(I,!0);v(()=>N(L,y()?`${O()(w.PROFILE)} : ${y()}`:O()(w.PROFILE_DEFAULT))),l(I),l(x);var j=o(x,2);tt(j,{get offsetsByScore(){return e(u)},get currentOffset(){return e(s)},set currentOffset(r){E(s,r)},$$legacy:!0});var b=o(j,2);he(b,{});var G=o(b,2);qe(G,5,()=>({length:me}),fe,(r,d,S)=>{var M=nt();we(M,"id",`reward-${S}`);var z=a(M),re=Ie(()=>p(e(s)));Ve(z,{get reward(){return e(t)[S]},index:S,get currentIndex(){return e(re)},get personalCalendar(){return e(_)}}),l(M),m(r,M)}),l(G),l(R),m(n,R)},$$slots:{default:!0}}),m(F,h),Se()}oe(["click"]);export{St as component};
