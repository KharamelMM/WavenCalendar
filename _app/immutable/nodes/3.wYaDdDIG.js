import{g as oe,s as pe,b as E,a as m,t as P,f as le,c as Z,e as qe}from"../chunks/disclose-version.DARnoLUY.js";import{i as de}from"../chunks/legacy.uhxq8U6e.js";import{p as se,P as N,af as Y,ag as _e,G as e,a as Se,ah as C,I as X,a4 as Oe,f as B,c as u,r as l,s as o,t as x,ai as Te,aj as Ue}from"../chunks/utils.DS7Odsae.js";import{i as H}from"../chunks/if.DRdOVeSS.js";import{l as ie,g as xe,T as Re,o as ye,C as ue,R as ne,s as Le,c as ce,e as Ce,i as Ie,a as be,F as ge,P as he,b as He,d as me}from"../chunks/Filters.Dj2uIHTF.js";import{C as Ke,b as Fe,t as ve,s as Qe}from"../chunks/Modal.BNz1O048.js";import{m as $e,F as we}from"../chunks/FlyingSection._X_2QlY3.js";import{t as De,a as je,b as Ee,d as Q}from"../chunks/client.A4bxOfeX.js";import{p as W,b as Ae,s as Ge}from"../chunks/preload-helper.ClI4wH-8.js";import{g as Me}from"../chunks/index.CiEhDQPL.js";const ke=[{cycle_index:0,type:"KAMAS",rarety:null,equipment:null,item:null,amount:1},{cycle_index:1,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:2,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:100},{cycle_index:3,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:80},{cycle_index:4,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:5,type:"KAMAS",rarety:null,equipment:null,item:null,amount:5e3},{cycle_index:6,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:7,type:"EQUIPMENT",rarety:"RARE",equipment:null,item:"RING",amount:20},{cycle_index:8,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2e3},{cycle_index:9,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:10,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:11,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:12,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:13,type:"COMPANION",rarety:"COMMON",equipment:null,item:"COMPANION",amount:10},{cycle_index:14,type:"EQUIPMENT",rarety:"COMMON",equipment:null,item:"ARMBAND",amount:20},{cycle_index:15,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:16,type:"COMPANION",rarety:"KROSMIC",equipment:null,item:"COMPANION",amount:5},{cycle_index:17,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:18,type:"EQUIPMENT",rarety:"KROSMIC",equipment:null,item:"RING",amount:5},{cycle_index:19,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:20,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:21,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:22,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:23,type:"KAMAS",rarety:null,equipment:null,item:null,amount:1e3},{cycle_index:24,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2e3},{cycle_index:25,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:100},{cycle_index:26,type:"WAKFU",rarety:null,equipment:null,item:null,amount:999},{cycle_index:27,type:"EQUIPMENT",rarety:"RARE",equipment:null,item:null,amount:10},{cycle_index:28,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:20},{cycle_index:29,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:2},{cycle_index:30,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:31,type:"WAKFU",rarety:null,equipment:null,item:null,amount:1e3},{cycle_index:32,type:"GEMS",rarety:null,equipment:null,item:null,amount:150},{cycle_index:33,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:34,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:1},{cycle_index:35,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:36,type:"KAMAS",rarety:null,equipment:null,item:null,amount:1e3},{cycle_index:37,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:40},{cycle_index:41,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:100},{cycle_index:48,type:"COMPANION",rarety:"RARE",equipment:null,item:"COMPANION",amount:10},{cycle_index:49,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:1},{cycle_index:51,type:"EQUIPMENT",rarety:"RARE",equipment:null,item:"RING",amount:20},{cycle_index:52,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:80},{cycle_index:53,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:5},{cycle_index:54,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:55,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:56,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:1},{cycle_index:57,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:58,type:"COMPANION",rarety:"INFINITE",equipment:null,item:null,amount:1},{cycle_index:59,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:60,type:"EQUIPMENT",rarety:"KROSMIC",equipment:null,item:null,amount:20},{cycle_index:61,type:"KAMAS",rarety:null,equipment:null,item:null,amount:5e3},{cycle_index:62,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:63,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:1},{cycle_index:64,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:65,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:2},{cycle_index:66,type:"GEMS",rarety:null,equipment:null,item:null,amount:200},{cycle_index:67,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:68,type:"KAMAS",rarety:null,equipment:null,item:null,amount:1e3},{cycle_index:69,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:70,type:"COMPANION",rarety:"COMMON",equipment:null,item:null,amount:50},{cycle_index:71,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:72,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:1},{cycle_index:73,type:"WAKFU",rarety:null,equipment:null,item:null,amount:3e3},{cycle_index:80,type:"WAKFU",rarety:null,equipment:null,item:null,amount:3e3},{cycle_index:81,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:2},{cycle_index:82,type:"EQUIPMENT",rarety:"INFINITE",equipment:null,item:null,amount:1},{cycle_index:93,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:103,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:104,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:105,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:106,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:107,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:5},{cycle_index:130,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:150,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:20},{cycle_index:155,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:182,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:80},{cycle_index:183,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:184,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:185,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:186,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:187,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:188,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:40},{cycle_index:189,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2e3},{cycle_index:190,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:191,type:"EQUIPMENT",rarety:"COMMON",equipment:null,item:"RING",amount:9},{cycle_index:192,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:100},{cycle_index:193,type:"COMPANION",rarety:"KROSMIC",equipment:null,item:"COMPANION",amount:20},{cycle_index:194,type:"COMPANION",rarety:"INFINITE",equipment:null,item:"COMPANION",amount:5},{cycle_index:195,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:196,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:197,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:1},{cycle_index:198,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:199,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:20},{cycle_index:200,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:2},{cycle_index:201,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:202,type:"KAMAS",rarety:null,equipment:null,item:null,amount:1999},{cycle_index:203,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:20},{cycle_index:204,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:205,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:2},{cycle_index:206,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:207,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:100},{cycle_index:209,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:210,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:211,type:"KAMAS",rarety:null,equipment:null,item:null,amount:1e3},{cycle_index:212,type:"KAMAS",rarety:null,equipment:null,item:null,amount:5e3},{cycle_index:213,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:1},{cycle_index:216,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:275,type:"EQUIPMENT",rarety:"INFINITE",equipment:null,item:"RING",amount:1},{cycle_index:279,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:317,type:"KAMAS",rarety:null,equipment:null,item:null,amount:9e3},{cycle_index:336,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:339,type:"COMPANION",rarety:"KROSMIC",equipment:null,item:"COMPANION",amount:20},{cycle_index:340,type:"COMPANION",rarety:"INFINITE",equipment:null,item:"COMPANION",amount:5},{cycle_index:349,type:"EQUIPMENT",rarety:"RARE",equipment:null,item:"RING",amount:20},{cycle_index:350,type:"COMPANION",rarety:"COMMON",equipment:null,item:"COMPANION",amount:1},{cycle_index:351,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:100},{cycle_index:352,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:2},{cycle_index:353,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:354,type:"COMPANION",rarety:"COMMON",equipment:null,item:"COMPANION",amount:20},{cycle_index:355,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:356,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:100},{cycle_index:357,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:358,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:359,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:2},{cycle_index:360,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:361,type:"KAMAS",rarety:null,equipment:null,item:null,amount:1e3},{cycle_index:362,type:"EQUIPMENT",rarety:"COMMON",equipment:null,item:null,amount:20},{cycle_index:363,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:364,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:2}];var We=P(" <!>",1),Ye=P('<button class="validate material-icon svelte-1df2l99">check_circle</button>'),Be=P('<div class="header svelte-1df2l99"><small><!></small> <small> </small></div> <b><!></b> <!>',1);function Ve(K,y){se(y,!1);const f=pe(),q=()=>Z($e,"$momentStore",f),c=()=>Z(Ee,"$_",f),r=C();let t=W(y,"reward",8),_=W(y,"index",8),p=W(y,"currentIndex",24,()=>-1),b=W(y,"personalCalendar",24,()=>[]),T=C(!1),d=C("");const I=ie.subscribe(i=>{N(d,xe(t(),i.filters))});Ae(()=>{I()});async function g(){if(!t())throw new Error("No reward to save");if(!e(r))throw new Error("Cannot save a reward that is not the current day");const i={...t()};i.cycle_index=ye(new Date,ue),i.validated=!0,await Le(Me(ce),i),N(T,!0)}Y(()=>(X(_()),X(p())),()=>{N(r,_()===p())}),Y(()=>(e(r),X(b()),ue),()=>{var i;e(r)&&N(T,((i=b()[ye(new Date,ue)])==null?void 0:i.validated)??!1)}),Y(()=>(X(t()),ie),()=>{N(d,xe(t(),Me(ie).filters))}),_e(),de();var F=Oe(()=>q()().add(_()-p(),"days").format("dddd DD MMMM YYYY"));Re(K,{get title(){return e(F)},children:(i,V)=>{Ke(i,Ge({get classes(){return e(d)},width:"10em",height:"3.5em"},()=>({primary:e(r),outline:e(r)}),{children:(n,ee)=>{var U=Be(),R=B(U),A=u(R),$=u(A);{var w=a=>{var s=le();x(()=>E(s,q()().add(_()-p(),"days").format("DD MMM"))),m(a,s)};H($,a=>{p()>0&&a(w)})}l(A);var D=o(A,2),v=u(D,!0);l(D),l(R);var O=o(R,2),h=u(O);{var j=a=>{var s=We(),S=B(s);x(()=>E(S,`${t().amount??""}x ${c()(t().type)??""} `));var M=o(S);{var z=k=>{var J=le();x(()=>E(J,c()(t().rarety))),m(k,J)},ae=k=>{var J=qe(),Pe=B(J);{var fe=re=>{var Ne=le();x(()=>E(Ne,c()(t().equipment))),m(re,Ne)};H(Pe,re=>{(t().type===ne.RUNES||t().type===ne.CHEST)&&re(fe)},!0)}m(k,J)};H(M,k=>{t().type===ne.EQUIPMENT||t().type===ne.COMPANION?k(z):k(ae,!1)})}m(a,s)},L=a=>{var s=le("-");m(a,s)};H(h,a=>{t()?a(j):a(L,!1)})}l(O);var G=o(O,2);{var te=a=>{var s=Ye();s.__click=g,De(3,s,()=>je,()=>({easing:Fe,duration:500})),m(a,s)};H(G,a=>{t()&&e(r)&&!e(T)&&a(te)})}x(()=>E(v,_())),m(n,U)},$$slots:{default:!0}}))},$$slots:{default:!0}}),Se()}oe(["click"]);var ze=P('<td class="svelte-1puj17x"><button class="material-icon svelte-1puj17x" disabled>task_alt</button></td>'),Je=(K,y,f)=>y(e(f)),Xe=P('<td class="svelte-1puj17x"><button class="material-icon svelte-1puj17x">radio_button_unchecked</button></td>'),Ze=P('<tr class="svelte-1puj17x"><td class="svelte-1puj17x"> </td><td class="svelte-1puj17x"> </td><!></tr>'),et=P('<section class="svelte-1puj17x"><table><thead class="svelte-1puj17x"><tr class="svelte-1puj17x"><th class="svelte-1puj17x"> </th><th class="svelte-1puj17x"> </th><th class="svelte-1puj17x"></th></tr></thead><tbody></tbody></table></section> <div class="info svelte-1puj17x"> </div>',1);function tt(K,y){se(y,!1);const f=pe(),q=()=>Z(Ee,"$_",f);let c=W(y,"offsetsByScore",8),r=W(y,"currentOffset",12),t=C([]),_=C(0);Y(()=>(e(t),X(c())),()=>{N(t,Object.keys(c()).sort((d,I)=>c()[+I]-c()[+d])),N(_,Object.values(c()).reduce((d,I)=>d+I,0)),console.log(c()),r(e(t)[0])}),_e(),de();var p=qe(),b=B(p);{var T=d=>{var I=et(),g=B(I),F=u(g),i=u(F),V=u(i),n=u(V),ee=u(n,!0);x(()=>E(ee,q()(Q.CALENDAR_OFFSET_KEY))),l(n);var U=o(n),R=u(U,!0);x(()=>E(R,q()(Q.CALENDAR_OFFSET_PROBABILITY_KEY))),l(U),Te(),l(V),l(i);var A=o(i);Ce(A,5,()=>e(t),Ie,(D,v)=>{var O=Ze(),h=u(O),j=u(h,!0);l(h);var L=o(h),G=u(L);x(()=>E(G,`${Math.round(c()[e(v)]/e(_)*1e3)/10}%`)),l(L);var te=o(L);{var a=S=>{var M=ze();m(S,M)},s=S=>{var M=Xe(),z=u(M);z.__click=[Je,r,v],l(M),m(S,M)};H(te,S=>{e(v)===r()?S(a):S(s,!1)})}l(O),x(()=>{ve(h,"bold",e(v)===r()),E(j,e(v)),ve(L,"bold",e(v)===r())}),m(D,O)}),l(A),l(F),l(g);var $=o(g,2),w=u($,!0);x(()=>E(w,q()(Q.CALENDAR_OFFSET_INFO))),l($),m(d,I)};H(b,d=>{Object.keys(c()).length>0&&d(T)})}m(K,p),Se()}oe(["click"]);var lt=(K,y)=>N(y,!0),nt=P('<div class="reward"><!></div>'),ut=P('<div class="body svelte-igihim"><div class="info svelte-igihim"><h2> </h2> <div class="svelte-igihim"> </div></div> <div><button class="profile"> </button></div> <!> <!> <section class="svelte-igihim"></section></div>'),at=P("<!> <!>",1);function St(K,y){se(y,!1);const f=pe(),q=()=>Z(Ee,"$_",f),c=()=>Z(ce,"$currentProfile",f),r=C(),t=C([]);let _=C([]),p=C(-1),b=C(-1),T=C(!1);for(const n of ke)Ue(t,e(t)[n.cycle_index]=n);function d(n){return n<0?-1:(ye(new Date,ue)-n+me)%me}const I=ce.subscribe(async n=>{N(_,await be(n))});Ae(()=>{I()}),Y(()=>(e(_),e(t)),()=>{N(r,He(e(_),e(t)))}),Y(()=>(e(b),e(p)),()=>{N(b,d(e(p)));const n=document.querySelector(`#reward-${e(b)}`);n&&n.scrollIntoView({block:"center",behavior:"smooth"})}),_e(),de();var g=at(),F=B(g);{var i=n=>{he(n,{onclose:()=>N(T,!1)})};H(F,n=>{e(T)&&n(i)})}var V=o(F,2);we(V,{children:(n,ee)=>{var U=ut(),R=u(U),A=u(R),$=u(A,!0);x(()=>E($,q()(Q.CALENDAR_TITLE))),l(A);var w=o(A,2),D=u(w,!0);x(()=>E(D,q()(Q.CALENDAR_INFO))),l(w),l(R);var v=o(R,2),O=u(v);O.__click=[lt,T];var h=u(O,!0);x(()=>E(h,c()?`${q()(Q.PROFILE)} : ${c()}`:q()(Q.PROFILE_DEFAULT))),l(O),l(v);var j=o(v,2);tt(j,{get offsetsByScore(){return e(r)},get currentOffset(){return e(p)},set currentOffset(a){N(p,a)},$$legacy:!0});var L=o(j,2);ge(L,{});var G=o(L,2);Ce(G,5,()=>({length:me}),Ie,(a,s,S)=>{var M=nt();Qe(M,"id",`reward-${S}`);var z=u(M),ae=Oe(()=>d(e(p)));Ve(z,{get reward(){return e(t)[S]},index:S,get currentIndex(){return e(ae)},get personalCalendar(){return e(_)}}),l(M),m(a,M)}),l(G),l(U),m(n,U)},$$slots:{default:!0}}),m(K,g),Se()}oe(["click"]);export{St as component};
