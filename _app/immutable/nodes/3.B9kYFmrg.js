import{g as oe,s as se,b as N,a as c,t as P,f as le,c as Z,e as Ie}from"../chunks/disclose-version.DARnoLUY.js";import{i as de}from"../chunks/legacy.uhxq8U6e.js";import{p as pe,P as S,af as B,ag as _e,G as e,a as ve,ah as f,I as X,a4 as Me,f as W,c as a,r as l,s as o,t as E,ai as Te,aj as Re}from"../chunks/utils.DS7Odsae.js";import{i as $}from"../chunks/if.DRdOVeSS.js";import{l as ie,g as Ee,T as be,o as me,C as ae,R as ne,s as Ue,c as ye,e as fe,i as Ce,a as ge,F as he,P as Le,b as $e,d as ce}from"../chunks/Filters.Dj2uIHTF.js";import{C as Fe,b as we,t as xe,s as He}from"../chunks/Modal.BNz1O048.js";import{m as Ke,F as Qe}from"../chunks/FlyingSection._X_2QlY3.js";import{t as De,a as je,b as Ne,d as H}from"../chunks/client.A4bxOfeX.js";import{p as Y,b as qe,s as Ge}from"../chunks/preload-helper.ClI4wH-8.js";import{g as Oe}from"../chunks/index.CiEhDQPL.js";const ke=[{cycle_index:0,type:"KAMAS",rarety:null,equipment:null,item:null,amount:1},{cycle_index:11,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:12,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:13,type:"COMPANION",rarety:"COMMON",equipment:null,item:"COMPANION",amount:10},{cycle_index:14,type:"EQUIPMENT",rarety:"COMMON",equipment:null,item:"ARMBAND",amount:20},{cycle_index:15,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:16,type:"COMPANION",rarety:"KROSMIC",equipment:null,item:"COMPANION",amount:5},{cycle_index:17,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:18,type:"EQUIPMENT",rarety:"KROSMIC",equipment:null,item:"RING",amount:5},{cycle_index:19,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:20,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:21,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:22,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:23,type:"KAMAS",rarety:null,equipment:null,item:null,amount:1e3},{cycle_index:24,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2e3},{cycle_index:25,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:100},{cycle_index:41,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:100},{cycle_index:48,type:"COMPANION",rarety:"RARE",equipment:null,item:"COMPANION",amount:10},{cycle_index:49,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:1},{cycle_index:51,type:"EQUIPMENT",rarety:"RARE",equipment:null,item:"RING",amount:20},{cycle_index:52,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:80},{cycle_index:53,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:5},{cycle_index:54,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:55,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:56,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:1},{cycle_index:57,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:58,type:"COMPANION",rarety:"INFINITE",equipment:null,item:"COMPANION",amount:1},{cycle_index:59,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:60,type:"EQUIPMENT",rarety:"KROSMIC",equipment:null,item:"RING",amount:20},{cycle_index:61,type:"KAMAS",rarety:null,equipment:null,item:null,amount:5e3},{cycle_index:62,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:63,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:1},{cycle_index:64,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:65,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:2},{cycle_index:66,type:"GEMS",rarety:null,equipment:null,item:null,amount:200},{cycle_index:67,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:82,type:"EQUIPMENT",rarety:"INFINITE",equipment:null,item:"RING",amount:1},{cycle_index:93,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:103,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:107,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:5},{cycle_index:130,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:150,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:20},{cycle_index:155,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:182,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:80},{cycle_index:183,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:184,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:185,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:186,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:187,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:188,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:40},{cycle_index:189,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2e3},{cycle_index:190,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:191,type:"EQUIPMENT",rarety:"COMMON",equipment:null,item:"RING",amount:9},{cycle_index:192,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:100},{cycle_index:193,type:"COMPANION",rarety:"KROSMIC",equipment:null,item:"COMPANION",amount:20},{cycle_index:194,type:"COMPANION",rarety:"INFINITE",equipment:null,item:"COMPANION",amount:5},{cycle_index:195,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:196,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:197,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:1},{cycle_index:198,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:199,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:20},{cycle_index:200,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:2},{cycle_index:202,type:"KAMAS",rarety:null,equipment:null,item:null,amount:1999},{cycle_index:203,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:20},{cycle_index:204,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:205,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:2},{cycle_index:206,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:207,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:100},{cycle_index:209,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:210,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:275,type:"EQUIPMENT",rarety:"INFINITE",equipment:null,item:"RING",amount:1},{cycle_index:279,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:336,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:339,type:"COMPANION",rarety:"KROSMIC",equipment:null,item:"COMPANION",amount:20},{cycle_index:340,type:"COMPANION",rarety:"INFINITE",equipment:null,item:"COMPANION",amount:5},{cycle_index:354,type:"EQUIPMENT",rarety:"COMMON",equipment:null,item:"RING",amount:1}];var Ye=P(" <!>",1),Be=P('<button class="validate material-icon svelte-1df2l99">check_circle</button>'),We=P('<div class="header svelte-1df2l99"><small><!></small> <small> </small></div> <b><!></b> <!>',1);function Ve(F,m){pe(m,!1);const A=se(),I=()=>Z(Ke,"$momentStore",A),y=()=>Z(Ne,"$_",A),u=f();let t=Y(m,"reward",8),_=Y(m,"index",8),s=Y(m,"currentIndex",24,()=>-1),g=Y(m,"personalCalendar",24,()=>[]),T=f(!1),d=f("");const C=ie.subscribe(i=>{S(d,Ee(t(),i.filters))});qe(()=>{C()});async function h(){if(!t())throw new Error("No reward to save");if(!e(u))throw new Error("Cannot save a reward that is not the current day");const i={...t()};i.cycle_index=me(new Date,ae),i.validated=!0,await Ue(Oe(ye),i),S(T,!0)}B(()=>(X(_()),X(s())),()=>{S(u,_()===s())}),B(()=>(e(u),X(g()),ae),()=>{var i;e(u)&&S(T,((i=g()[me(new Date,ae)])==null?void 0:i.validated)??!1)}),B(()=>(X(t()),ie),()=>{S(d,Ee(t(),Oe(ie).filters))}),_e(),de();var w=Me(()=>I()().add(_()-s(),"days").format("dddd DD MMMM YYYY"));be(F,{get title(){return e(w)},children:(i,V)=>{Fe(i,Ge({get classes(){return e(d)},width:"10em",height:"3.5em"},()=>({primary:e(u),outline:e(u)}),{children:(n,ee)=>{var R=We(),b=W(R),q=a(b),K=a(q);{var Q=r=>{var p=le();E(()=>N(p,I()().add(_()-s(),"days").format("DD MMM"))),c(r,p)};$(K,r=>{s()>0&&r(Q)})}l(q);var D=o(q,2),x=a(D,!0);l(D),l(b);var M=o(b,2),L=a(M);{var j=r=>{var p=Ye(),v=W(p);E(()=>N(v,`${t().amount??""}x ${y()(t().type)??""} `));var O=o(v);{var z=k=>{var J=le();E(()=>N(J,y()(t().rarety))),c(k,J)},re=k=>{var J=Ie(),Pe=W(J);{var Ae=ue=>{var Se=le();E(()=>N(Se,y()(t().equipment))),c(ue,Se)};$(Pe,ue=>{(t().type===ne.RUNES||t().type===ne.CHEST)&&ue(Ae)},!0)}c(k,J)};$(O,k=>{t().type===ne.EQUIPMENT||t().type===ne.COMPANION?k(z):k(re,!1)})}c(r,p)},U=r=>{var p=le("-");c(r,p)};$(L,r=>{t()?r(j):r(U,!1)})}l(M);var G=o(M,2);{var te=r=>{var p=Be();p.__click=h,De(3,p,()=>je,()=>({easing:we,duration:500})),c(r,p)};$(G,r=>{t()&&e(u)&&!e(T)&&r(te)})}E(()=>N(x,_())),c(n,R)},$$slots:{default:!0}}))},$$slots:{default:!0}}),ve()}oe(["click"]);var ze=P('<td class="svelte-1puj17x"><button class="material-icon svelte-1puj17x" disabled>task_alt</button></td>'),Je=(F,m,A)=>m(e(A)),Xe=P('<td class="svelte-1puj17x"><button class="material-icon svelte-1puj17x">radio_button_unchecked</button></td>'),Ze=P('<tr class="svelte-1puj17x"><td class="svelte-1puj17x"> </td><td class="svelte-1puj17x"> </td><!></tr>'),et=P('<section class="svelte-1puj17x"><table><thead class="svelte-1puj17x"><tr class="svelte-1puj17x"><th class="svelte-1puj17x"> </th><th class="svelte-1puj17x"> </th><th class="svelte-1puj17x"></th></tr></thead><tbody></tbody></table></section> <div class="info svelte-1puj17x"> </div>',1);function tt(F,m){pe(m,!1);const A=se(),I=()=>Z(Ne,"$_",A);let y=Y(m,"offsetsByScore",8),u=Y(m,"currentOffset",12),t=f([]),_=f(0);B(()=>(e(t),X(y())),()=>{S(t,Object.keys(y()).sort((d,C)=>y()[+C]-y()[+d])),S(_,Object.values(y()).reduce((d,C)=>d+C,0)),console.log(y()),u(e(t)[0])}),_e(),de();var s=Ie(),g=W(s);{var T=d=>{var C=et(),h=W(C),w=a(h),i=a(w),V=a(i),n=a(V),ee=a(n,!0);E(()=>N(ee,I()(H.CALENDAR_OFFSET_KEY))),l(n);var R=o(n),b=a(R,!0);E(()=>N(b,I()(H.CALENDAR_OFFSET_PROBABILITY_KEY))),l(R),Te(),l(V),l(i);var q=o(i);fe(q,5,()=>e(t),Ce,(D,x)=>{var M=Ze(),L=a(M),j=a(L,!0);l(L);var U=o(L),G=a(U);E(()=>N(G,`${Math.round(y()[e(x)]/e(_)*1e3)/10}%`)),l(U);var te=o(U);{var r=v=>{var O=ze();c(v,O)},p=v=>{var O=Xe(),z=a(O);z.__click=[Je,u,x],l(O),c(v,O)};$(te,v=>{e(x)===u()?v(r):v(p,!1)})}l(M),E(()=>{xe(L,"bold",e(x)===u()),N(j,e(x)),xe(U,"bold",e(x)===u())}),c(D,M)}),l(q),l(w),l(h);var K=o(h,2),Q=a(K,!0);E(()=>N(Q,I()(H.CALENDAR_OFFSET_INFO))),l(K),c(d,C)};$(g,d=>{Object.keys(y()).length>0&&d(T)})}c(F,s),ve()}oe(["click"]);var lt=(F,m)=>S(m,!0),nt=P('<div class="reward"><!></div>'),at=P('<div class="body svelte-igihim"><div class="info svelte-igihim"><h2> </h2> <div class="svelte-igihim"> </div></div> <div><button class="profile"> </button></div> <!> <!> <section class="svelte-igihim"></section></div>'),rt=P("<!> <!>",1);function vt(F,m){pe(m,!1);const A=se(),I=()=>Z(Ne,"$_",A),y=()=>Z(ye,"$currentProfile",A),u=f(),t=f([]);let _=f([]),s=f(-1),g=f(-1),T=f(!1);for(const n of ke)Re(t,e(t)[n.cycle_index]=n);function d(n){return n<0?-1:(me(new Date,ae)-n+ce)%ce}const C=ye.subscribe(async n=>{S(_,await ge(n))});qe(()=>{C()}),B(()=>(e(_),e(t)),()=>{S(u,$e(e(_),e(t)))}),B(()=>(e(g),e(s)),()=>{S(g,d(e(s)));const n=document.querySelector(`#reward-${e(g)}`);n&&n.scrollIntoView({block:"center",behavior:"smooth"})}),_e(),de();var h=rt(),w=W(h);{var i=n=>{Le(n,{onclose:()=>S(T,!1)})};$(w,n=>{e(T)&&n(i)})}var V=o(w,2);Qe(V,{children:(n,ee)=>{var R=at(),b=a(R),q=a(b),K=a(q,!0);E(()=>N(K,I()(H.CALENDAR_TITLE))),l(q);var Q=o(q,2),D=a(Q,!0);E(()=>N(D,I()(H.CALENDAR_INFO))),l(Q),l(b);var x=o(b,2),M=a(x);M.__click=[lt,T];var L=a(M,!0);E(()=>N(L,y()?`${I()(H.PROFILE)} : ${y()}`:I()(H.PROFILE_DEFAULT))),l(M),l(x);var j=o(x,2);tt(j,{get offsetsByScore(){return e(u)},get currentOffset(){return e(s)},set currentOffset(r){S(s,r)},$$legacy:!0});var U=o(j,2);he(U,{});var G=o(U,2);fe(G,5,()=>({length:ce}),Ce,(r,p,v)=>{var O=nt();He(O,"id",`reward-${v}`);var z=a(O),re=Me(()=>d(e(s)));Ve(z,{get reward(){return e(t)[v]},index:v,get currentIndex(){return e(re)},get personalCalendar(){return e(_)}}),l(O),c(r,O)}),l(G),l(R),c(n,R)},$$slots:{default:!0}}),c(F,h),ve()}oe(["click"]);export{vt as component};
