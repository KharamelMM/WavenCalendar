import{d as oe,s as pe,b as _,a as i,t as A,e as K,c as j,f as qe}from"../chunks/disclose-version.uy8RbVP_.js";import{i as se}from"../chunks/legacy.Db3jXcoH.js";import{p as de,L as o,M as Y,N as _e,G as e,a as Ne,O as N,I as D,P as Se,f as B,c,r as m,s as d,t as S,Q as Pe}from"../chunks/utils.CUNAnymL.js";import{i as f}from"../chunks/if.BwXDAm1f.js";import{l as le,g as ye,T as fe,o as ae,C as V,R as G,s as Ae,c as re,a as Te,F as Ue,e as Re,P as ge,i as Le,b as be,d as ne}from"../chunks/Filters.Co-zQY4P.js";import{C as $e,b as he,s as we}from"../chunks/Modal.C6EBVnI4.js";import{m as Qe,F as He}from"../chunks/FlyingSection.0cTW2p4j.js";import{t as Fe,s as Ke,$ as Ee,a as k}from"../chunks/client.Bw9zwrEO.js";import{p as W,o as xe,s as De}from"../chunks/preload-helper.DIGldzjJ.js";import{g as ce}from"../chunks/index.BOtyADB3.js";const Ge=[{cycle_index:0,type:"KAMAS",rarety:null,equipment:null,item:null,amount:1},{cycle_index:11,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:12,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:13,type:"COMPANION",rarety:"COMMON",equipment:null,item:"COMPANION",amount:10},{cycle_index:14,type:"EQUIPMENT",rarety:"COMMON",equipment:null,item:"ARMBAND",amount:20},{cycle_index:15,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:16,type:"COMPANION",rarety:"KROSMIC",equipment:null,item:"COMPANION",amount:5},{cycle_index:17,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:18,type:"EQUIPMENT",rarety:"KROSMIC",equipment:null,item:"RING",amount:5},{cycle_index:19,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:20,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:21,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:22,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:23,type:"KAMAS",rarety:null,equipment:null,item:null,amount:1e3},{cycle_index:24,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2e3},{cycle_index:25,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:100},{cycle_index:41,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:100},{cycle_index:48,type:"COMPANION",rarety:"RARE",equipment:null,item:"COMPANION",amount:10},{cycle_index:49,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:1},{cycle_index:51,type:"EQUIPMENT",rarety:"RARE",equipment:null,item:"RING",amount:20},{cycle_index:52,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:80},{cycle_index:53,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:5},{cycle_index:54,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:55,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:56,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:1},{cycle_index:57,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:58,type:"COMPANION",rarety:"INFINITE",equipment:null,item:"COMPANION",amount:1},{cycle_index:59,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:60,type:"EQUIPMENT",rarety:"KROSMIC",equipment:null,item:"RING",amount:20},{cycle_index:61,type:"KAMAS",rarety:null,equipment:null,item:null,amount:5e3},{cycle_index:62,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:63,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:1},{cycle_index:64,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:65,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:2},{cycle_index:66,type:"GEMS",rarety:null,equipment:null,item:null,amount:200},{cycle_index:67,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:82,type:"EQUIPMENT",rarety:"INFINITE",equipment:null,item:"RING",amount:1},{cycle_index:93,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:103,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:107,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:5},{cycle_index:130,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:150,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:20},{cycle_index:155,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:182,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:80},{cycle_index:183,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:184,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:185,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:186,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:187,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:188,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:40},{cycle_index:189,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2e3},{cycle_index:190,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:191,type:"EQUIPMENT",rarety:"COMMON",equipment:null,item:"RING",amount:9},{cycle_index:192,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:100},{cycle_index:193,type:"COMPANION",rarety:"KROSMIC",equipment:null,item:"COMPANION",amount:20},{cycle_index:194,type:"COMPANION",rarety:"INFINITE",equipment:null,item:"COMPANION",amount:5},{cycle_index:195,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:20},{cycle_index:196,type:"KAMAS",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:197,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:1},{cycle_index:198,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:199,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:20},{cycle_index:200,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:2},{cycle_index:202,type:"KAMAS",rarety:null,equipment:null,item:null,amount:1999},{cycle_index:203,type:"RUNES",rarety:null,equipment:"EQUIPMENTS",item:null,amount:20},{cycle_index:204,type:"CHEST",rarety:null,equipment:"SPELLS",item:null,amount:1},{cycle_index:205,type:"CHEST",rarety:null,equipment:"COMPANIONS",item:null,amount:2},{cycle_index:206,type:"CHEST",rarety:null,equipment:"EQUIPMENTS",item:null,amount:1},{cycle_index:207,type:"RUNES",rarety:null,equipment:"SPELLS",item:null,amount:100},{cycle_index:209,type:"RUNES",rarety:null,equipment:"COMPANIONS",item:null,amount:20},{cycle_index:210,type:"WAKFU",rarety:null,equipment:null,item:null,amount:2500},{cycle_index:275,type:"EQUIPMENT",rarety:"INFINITE",equipment:null,item:"RING",amount:1},{cycle_index:279,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:336,type:"GEMS",rarety:null,equipment:null,item:null,amount:100},{cycle_index:339,type:"COMPANION",rarety:"KROSMIC",equipment:null,item:"COMPANION",amount:20},{cycle_index:340,type:"COMPANION",rarety:"INFINITE",equipment:null,item:"COMPANION",amount:5},{cycle_index:354,type:"EQUIPMENT",rarety:"COMMON",equipment:null,item:"RING",amount:1}];var ke=A(" <!>",1),We=A('<button class="validate material-icon svelte-1df2l99">check_circle</button>'),Ye=A('<div class="header svelte-1df2l99"><small><!></small> <small> </small></div> <b><!></b> <!>',1);function Be(b,p){de(p,!1);const T=pe(),E=()=>j(Qe,"$momentStore",T),I=()=>j(Ee,"$_",T),a=N();let t=W(p,"reward",8),y=W(p,"index",8),s=W(p,"currentIndex",24,()=>-1),O=W(p,"personalCalendar",24,()=>[]),v=N(!1),U=N("");const $=le.subscribe(u=>{o(U,ye(t(),u.filters))});xe(()=>{$()});async function h(){if(!t())throw new Error("No reward to save");if(!e(a))throw new Error("Cannot save a reward that is not the current day");const u={...t()};u.cycle_index=ae(new Date,V),u.validated=!0,await Ae(ce(re),u),o(v,!0)}Y(()=>(D(y()),D(s())),()=>{o(a,y()===s())}),Y(()=>(e(a),D(O()),V),()=>{var u;e(a)&&o(v,((u=O()[ae(new Date,V)])==null?void 0:u.validated)??!1)}),Y(()=>(D(t()),le),()=>{o(U,ye(t(),ce(le).filters))}),_e(),se();var z=Se(()=>E()().add(y()-s(),"days").format("dddd DD MMMM YYYY"));fe(b,{get title(){return e(z)},children:(u,n)=>{$e(u,De({get classes(){return e(U)},width:"10em",height:"3.5em"},()=>({primary:e(a),outline:e(a)}),{children:(J,w)=>{var C=Ye(),x=B(C),R=c(x),Q=c(R);{var X=l=>{var r=K();S(()=>_(r,E()().add(y()-s(),"days").format("DD MMM"))),i(l,r)};f(Q,l=>{s()>0&&l(X)})}m(R);var M=d(R,2),Z=c(M,!0);m(M),m(x);var q=d(x,2),H=c(q);{var ue=l=>{var r=ke(),F=B(r);S(()=>_(F,`${t().amount??""}x ${I()(t().type)??""} `));var Me=d(F);{var Ie=P=>{var L=K();S(()=>_(L,I()(t().rarety))),i(P,L)},Oe=P=>{var L=qe(),ve=B(L);{var Ce=te=>{var me=K();S(()=>_(me,I()(t().equipment))),i(te,me)};f(ve,te=>{(t().type===G.RUNES||t().type===G.CHEST)&&te(Ce)},!0)}i(P,L)};f(Me,P=>{t().type===G.EQUIPMENT||t().type===G.COMPANION?P(Ie):P(Oe,!1)})}i(l,r)},ee=l=>{var r=K("-");i(l,r)};f(H,l=>{t()?l(ue):l(ee,!1)})}m(q);var ie=d(q,2);{var g=l=>{var r=We();r.__click=h,Fe(3,r,()=>Ke,()=>({easing:he,duration:500})),i(l,r)};f(ie,l=>{t()&&e(a)&&!e(v)&&l(g)})}S(()=>_(Z,y())),i(J,C)},$$slots:{default:!0}}))},$$slots:{default:!0}}),Ne()}oe(["click"]);var Ve=(b,p)=>o(p,!0),je=A('<div class="reward"><!></div>'),ze=A('<div class="body svelte-igihim"><div class="info svelte-igihim"><h2> </h2> <div class="svelte-igihim"> </div></div> <button class="profile"> </button> <!> <section class="svelte-igihim"></section></div>'),Je=A("<!> <!>",1);function mt(b,p){de(p,!1);const T=pe(),E=()=>j(Ee,"$_",T),I=()=>j(re,"$currentProfile",T),a=N([]);let t=N([]),y=N(-1),s=N(-1),O=N(!1);for(const n of Ge)Pe(a,e(a)[n.cycle_index]=n);function v(n){return n<0?-1:(ae(new Date,V)-n+ne)%ne}const U=re.subscribe(async n=>{o(t,await Te(n))});xe(()=>{U()}),Y(()=>(e(y),e(t),e(a),e(s)),()=>{o(y,be(e(t),e(a))),o(s,v(e(y)));const n=document.querySelector(`#reward-${e(s)}`);n&&n.scrollIntoView({block:"center",behavior:"smooth"})}),_e(),se();var $=Je(),h=B($);{var z=n=>{ge(n,{onclose:()=>o(O,!1)})};f(h,n=>{e(O)&&n(z)})}var u=d(h,2);He(u,{children:(n,J)=>{var w=ze(),C=c(w),x=c(C),R=c(x,!0);S(()=>_(R,E()(k.CALENDAR_TITLE))),m(x);var Q=d(x,2),X=c(Q,!0);S(()=>_(X,E()(k.CALENDAR_INFO))),m(Q),m(C);var M=d(C,2);M.__click=[Ve,O];var Z=c(M,!0);S(()=>_(Z,I()?`${E()(k.PROFILE)} : ${I()}`:E()(k.PROFILE_DEFAULT))),m(M);var q=d(M,2);Ue(q,{});var H=d(q,2);Re(H,5,()=>({length:ne}),Le,(ee,ie,g)=>{var l=je();we(l,"id",`reward-${g}`);var r=c(l),F=Se(()=>v(e(y)));Be(r,{get reward(){return e(a)[g]},index:g,get currentIndex(){return e(F)},get personalCalendar(){return e(t)}}),m(l),i(ee,l)}),m(H),m(w),i(n,w)},$$slots:{default:!0}}),i(b,$),Ne()}oe(["click"]);export{mt as component};
