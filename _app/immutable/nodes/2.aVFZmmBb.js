import{e as pe,s as ce,b as K,a as d,t as $,c as J,g as Me,f as De}from"../chunks/disclose-version.20gSIdwX.js";import{i as de}from"../chunks/legacy.Dm18BoVq.js";import{X as Re,Y as ze,av as Ve,aw as Xe,e as Ze,W as Je,a4 as et,a3 as tt,U as at,a5 as rt,p as ue,j as E,ax as st,T as ot,ay as nt,l as e,c as v,r as n,t as Q,a as ve,a6 as Y,E as w,s as R,D as lt,az as we,f as ne,aA as Le,aB as Te}from"../chunks/utils.C1YnwcYC.js";import{a as Ue,i as H,o as it}from"../chunks/preload-helper.B2mjMfXa.js";import{g as Ne,T as ct,s as Fe,t as We,R as m,e as le,i as ie,n as dt,m as Ye,d as ut,a as vt,o as me,b as Pe,E as Se,r as Oe,c as Ae,f as oe,F as Ce,h as _t,M as ft,P as yt,C as mt}from"../chunks/Filters.C2vgbJYG.js";import{p as g,s as he}from"../chunks/props.BTikEG_N.js";import{l as Ee,h as ge,D as Ie,C as be,b as Qe,t as W,i as qe,j as ht,M as bt,k as pt,m as gt}from"../chunks/calendar.DoLWxcG-.js";import{g as ye}from"../chunks/index.Bk94107-.js";function $t(i,t,r){Re&&ze();var l=i,c=at,_,a=Ve()?Xe:Ze;Je(()=>{a(c,c=t())&&(_&&et(_),_=tt(()=>r(l)))}),Re&&(l=rt)}var Et=$("<button><div> </div></button>");function kt(i,t){ue(t,!1);const r=ce(),l=()=>J(ge,"$_",r);let c=g(t,"currentDate",8),_=g(t,"dayOfMonth",8),a=g(t,"reward",8,void 0),y=g(t,"onclick",8);const s=new Date;let o=Y("");const h=Ee.subscribe(p=>{E(o,Ne(a(),p.filters))});function b(){if(a()){let p=`${a().amount}× ${l()(a().type)}`;switch(a().type){case m.RUNES:case m.CHEST:p+=` ${l()(a().equipment)}`;break;case m.COMPANION:case m.EQUIPMENT:p=`${a().amount}× ${l()(a().type)} ${l()(a().rarety)}`;break}return p}}Ue(()=>{h()}),st(()=>(ot(a()),Ee),()=>{E(o,Ne(a(),ye(Ee).filters))}),nt(),de();var k=w(b);ct(i,{get title(){return e(k)},children:(p,N)=>{var D=Et();D.__click=function(...X){var G;(G=y())==null||G.apply(this,X)};const q=w(()=>c().toDateString()===s.toDateString());var T=v(D),x=v(T,!0);n(T),n(D),Q(()=>{Fe(D,`${e(o)??""} svelte-14v7im1`),D.disabled=c()>s,We(D,"today",e(q)),K(x,_())}),d(p,D)},$$slots:{default:!0}}),ve()}pe(["click"]);var Mt=$('<th class="svelte-t5kud4"> </th>'),wt=$("<td><!></td>"),Dt=$("<tr></tr>"),Rt=$('<table class="svelte-t5kud4"><thead><tr></tr></thead><tbody></tbody></table>');function Tt(i,t){ue(t,!1);const r=ce(),l=()=>J(Ye,"$momentStore",r);let c=g(t,"year",8),_=g(t,"month",8),a=g(t,"onselectday",8),y=g(t,"calendar",8);const s=Ie.length;function o(N){let D=me(N,be);return y()[D]}de();var h=Rt(),b=v(h),k=v(b);le(k,5,()=>({length:s}),ie,(N,D,q)=>{var T=Mt(),x=v(T,!0);Q(()=>K(x,l()().weekday(q%s).format("dd"))),n(T),d(N,T)}),n(k),n(b);var p=R(b);le(p,5,()=>({length:dt(_(),c())}),ie,(N,D,q)=>{var T=Dt();const x=w(()=>ut(_(),c()));le(T,5,()=>Ie,ie,(G,re,u)=>{var B=wt();const P=w(()=>vt(_(),c(),u,q));var z=v(B);{var S=O=>{const A=w(()=>new Date(c(),_(),e(P))),L=w(()=>o(e(A)));var ee=lt(()=>({currentDate:e(A),dayOfMonth:e(P),reward:e(L),onclick:()=>a()(e(A))}));kt(O,he(()=>e(ee)))};H(z,O=>{e(P)>0&&e(P)<=e(x)&&O(S)})}n(B),d(G,B)}),n(T),d(N,T)}),n(p),n(h),d(i,h),ve()}function Nt(i,t){ue(t,!1);const r=ce(),l=()=>J(ge,"$_",r);let c=g(t,"key",8);de(),we();var _=Me();Q(()=>K(_,l()(c()))),d(i,_),ve()}var Pt=$('<span class="required svelte-u5ui8r">*</span>'),St=$("<span> <!></span>"),Ot=$('<section class="svelte-u5ui8r"><!> <!></section>');function Be(i,t){let r=g(t,"title",8,void 0),l=g(t,"required",8,!1);var c=Ot(),_=v(c);{var a=s=>{var o=St(),h=v(o),b=R(h);{var k=p=>{var N=Pt();d(p,N)};H(b,p=>{l()&&p(k)})}n(o),Q(()=>K(h,`${r()??""}: `)),d(s,o)};H(_,s=>{r()&&s(a)})}var y=R(_,2);Qe(y,t,"default",{}),n(c),d(i,c)}var At=(i,t,r)=>t(e(r)),Ct=$("<button><!></button>"),It=$('<section class="svelte-aefnkp"></section>');function ke(i,t){let r=g(t,"title",8,void 0),l=g(t,"values",24,()=>[]),c=g(t,"value",12),_=g(t,"required",8,!1);Be(i,he(()=>({title:r(),required:_()}),{children:(a,y)=>{var s=It();le(s,5,l,ie,(o,h)=>{var b=Ct();const k=w(()=>`${e(h).toLowerCase()??""} svelte-aefnkp`);b.__click=[At,c,h];var p=v(b);Nt(p,{get key(){return e(h)}}),n(b),Q(()=>{Fe(b,e(k)),We(b,"active",c()===e(h))}),d(o,b)}),n(s),d(a,s)},$$slots:{default:!0}}))}pe(["click"]);function qt(i){return Object.values(i).filter(t=>typeof t!="number")}var xt=$('<input type="number" min="100" max="250" step="50">'),Lt=$('<input type="number" min="1" max="5000">'),Ut=(i,t)=>t()(),Ft=(i,t,r)=>{confirm(t()(W.REWARD_DELETE_CONFIRM))&&r()()},Wt=$('<button class="delete material-icon svelte-tu6hhq">delete</button>'),Yt=$('<section class="svelte-tu6hhq"><!> <!> <!> <div class="controls svelte-tu6hhq"><button class="secondary svelte-tu6hhq"> </button> <button class="primary svelte-tu6hhq"> </button> <!></div></section>');function Qt(i,t){var ee,te,_e,ae,fe,se;ue(t,!1);const r=ce(),l=()=>J(ge,"$_",r);let c=g(t,"oncancel",8),_=g(t,"onsave",8),a=g(t,"ondelete",8,void 0),y=g(t,"reward",8,void 0),s=g(t,"date",8),o=Y(((ee=y())==null?void 0:ee.type)??m.EQUIPMENT),h=Y(((te=y())==null?void 0:te.type)===m.EQUIPMENT||((_e=y())==null?void 0:_e.type)===m.COMPANION?y().rarety:Pe.COMMON),b=Y(((ae=y())==null?void 0:ae.type)===m.RUNES||((fe=y())==null?void 0:fe.type)===m.CHEST?y().equipment:Se.EQUIPMENTS),k=Y(((se=y())==null?void 0:se.amount)??1);function p(){let f;const M={cycle_index:me(s(),be),amount:e(k)};switch(e(o)){case m.GEMS:f={...M,type:e(o),amount:e(k)};break;case m.EQUIPMENT:case m.COMPANION:f={...M,type:e(o),rarety:e(h)};break;case m.CHEST:f={...M,type:e(o),equipment:e(b)};break;case m.RUNES:f={...M,type:e(o),equipment:e(b)};break;case m.KAMAS:case m.WAKFU:f={...M,type:e(o)};break}_()(f)}de();var N=Yt(),D=v(N),q=w(()=>l()(W.REWARD_LABEL_TYPE)),T=w(()=>qt(m));ke(D,{get title(){return e(q)},get values(){return e(T)},get value(){return e(o)},set value(f){E(o,f)},required:!0,$$legacy:!0});var x=R(D,2);{var X=f=>{var M=w(()=>l()(W.REWARD_LABEL_RARITY)),V=w(()=>Object.keys(Pe));ke(f,{get title(){return e(M)},get values(){return e(V)},get value(){return e(h)},set value(C){E(h,C)},required:!0,$$legacy:!0})},G=f=>{var M=De(),V=ne(M);{var C=I=>{var j=w(()=>l()(W.REWARD_LABEL_EQUIPMENT_TYPE)),U=w(()=>Object.keys(Se));ke(I,{get title(){return e(j)},get values(){return e(U)},get value(){return e(b)},set value(F){E(b,F)},required:!0,$$legacy:!0})};H(V,I=>{(e(o)===m.CHEST||e(o)===m.RUNES)&&I(C)},!0)}d(f,M)};H(x,f=>{e(o)===m.EQUIPMENT||e(o)===m.COMPANION?f(X):f(G,!1)})}var re=R(x,2),u=w(()=>l()(W.REWARD_LABEL_AMOUNT));Be(re,{get title(){return e(u)},required:!0,children:(f,M)=>{var V=De(),C=ne(V);{var I=U=>{var F=xt();Oe(F),Ae(F,()=>e(k),Z=>E(k,Z)),d(U,F)},j=U=>{var F=Lt();Oe(F),Ae(F,()=>e(k),Z=>E(k,Z)),d(U,F)};H(C,U=>{e(o)===m.GEMS?U(I):U(j,!1)})}d(f,V)},$$slots:{default:!0}});var B=R(re,2),P=v(B);P.__click=[Ut,c];var z=v(P,!0);Q(()=>K(z,l()(W.CANCEL))),n(P);var S=R(P,2);S.__click=p;var O=v(S,!0);Q(()=>K(O,l()(W.SAVE))),n(S);var A=R(S,2);{var L=f=>{var M=Wt();M.__click=[Ft,l,a],d(f,M)};H(A,f=>{a()&&f(L)})}n(B),n(N),d(i,N),ve()}pe(["click"]);var Bt=$('<section class="material-icon"><!></section>');function xe(i,t){var r=Bt(),l=v(r);Qe(l,t,"default",{}),n(r),d(i,r)}var jt=$("<div> </div> <!>",1),Ht=(i,t)=>E(t,!0),Kt=(i,t,r)=>{E(t,!0),Le(r,-1)},Gt=(i,t,r)=>{E(t,!1),Le(r)},zt=$('<div class="months svelte-o5e3p2"></div>'),Vt=$('<div class="year svelte-o5e3p2"><!></div>'),Xt=$('<header class="svelte-o5e3p2"><button class="profile svelte-o5e3p2"> </button> <div class="year-controls svelte-o5e3p2"><button class="svelte-o5e3p2"><!></button> <h2 class="svelte-o5e3p2"> </h2> <button class="svelte-o5e3p2"><!></button></div> <div><!></div></header> <div class="calendar svelte-o5e3p2"><!></div>',1),Zt=$("<!> <!> <!>",1);function ca(i,t){ue(t,!1);const r=ce(),l=()=>J(Ye,"$momentStore",r),c=()=>J(ge,"$_",r),_=()=>J(oe,"$currentProfile",r);let a=Y([]),y=Y(new Date().getFullYear()),s=Y(),o=Y(!1),h=Y(!0);function b(u){E(s,u)}function k(u){if(!e(s))throw new Error("No selected day");u.validated=!1,Te(a,e(a)[me(e(s),be)]=u),E(s,void 0),pt(ye(oe),u)}function p(){if(!e(s))throw new Error("No selected day");return me(e(s),be)}function N(){if(!e(s))throw new Error("No selected day");const u=p();gt(ye(oe),u),Te(a,e(a)[u]=void 0),E(s,void 0)}const D=oe.subscribe(async u=>{E(a,await qe(u))});it(async()=>{E(a,await qe(ye(oe)))}),Ue(()=>{D()}),de();var q=Zt(),T=ne(q);{var x=u=>{var B=w(()=>l()(e(s)).format("dddd D MMMM yyyy"));ft(u,{get title(){return e(B)},onclose:()=>{E(s,void 0)},children:(P,z)=>{var S=jt(),O=ne(S),A=v(O,!0);Q(()=>K(A,c()(W.REWARDS_FORM_INFO))),n(O);var L=R(O,2);Qt(L,he({get reward(){return e(a)[p()]},oncancel:()=>{E(s,void 0)}},()=>({onsave:k,date:e(s),ondelete:N}))),d(P,S)},$$slots:{default:!0}})};H(T,u=>{e(s)&&u(x)})}var X=R(T,2);{var G=u=>{yt(u,{onclose:()=>E(o,!1)})};H(X,u=>{e(o)&&u(G)})}var re=R(X,2);Ce(re,{children:(u,B)=>{var P=Xt(),z=ne(P),S=v(z);S.__click=[Ht,o];var O=v(S,!0);Q(()=>K(O,_()!==ht?`${c()(W.PROFILE)} : ${_()}`:c()(W.PROFILE_DEFAULT))),n(S);var A=R(S,2),L=v(A);L.__click=[Kt,h,y];var ee=v(L);xe(ee,{children:(C,I)=>{we();var j=Me("arrow_back_ios");d(C,j)},$$slots:{default:!0}}),n(L);var te=R(L,2),_e=v(te,!0);n(te);var ae=R(te,2);ae.__click=[Gt,h,y];var fe=v(ae);xe(fe,{children:(C,I)=>{we();var j=Me("arrow_forward_ios");d(C,j)},$$slots:{default:!0}}),n(ae),n(A);var se=R(A,2),f=v(se);_t(f,{}),n(se),n(z);var M=R(z,2),V=v(M);$t(V,()=>e(y),C=>{var I=Vt(),j=v(I);Ce(j,{get leftToRight(){return e(h)},children:(U,F)=>{var Z=zt();le(Z,5,()=>bt,ie,(je,Jt,$e)=>{var He=w(()=>l()(new Date(0,$e)).format("MMMM")),Ke=w(()=>$e===new Date().getMonth()&&e(y)===new Date().getFullYear());mt(je,{get title(){return e(He)},get outline(){return e(Ke)},children:(Ge,ea)=>{Tt(Ge,he(()=>({month:$e,year:e(y),onselectday:b,calendar:e(a)})))},$$slots:{default:!0}})}),n(Z),d(U,Z)},$$slots:{default:!0}}),n(I),d(C,I)}),n(M),Q(()=>K(_e,e(y))),d(u,P)},$$slots:{default:!0}}),d(i,q),ve()}pe(["click"]);export{ca as component};
