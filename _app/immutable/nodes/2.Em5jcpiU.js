import{l as ft,a as y,t as A,b as z,g as Ue,s as pe,c as Me,f as De,e as qe,i as dt}from"../chunks/disclose-version.Cxw1R0xC.js";import{i as se}from"../chunks/legacy.D2rrnLXE.js";import{F as B,G as et,ax as _t,ay as ht,a as Et,E as tt,O as at,N as xe,U as yt,P as re,K as Se,ak as gt,aj as bt,D as pt,av as rt,I as Mt,J as Fe,L as Te,ar as Nt,az as ye,M as nt,A as We,aA as mt,aB as At,au as Rt,aC as St,aD as Tt,ah as Ot,a4 as It,w as Ke,aE as Dt,aF as wt,aG as $t,ap as kt,a7 as st,c as S,e as C,d as p,t as Q,p as le,j as s,b as oe,$ as I,ae as we,aH as Ct,af as W,y as P,f as ue,aI as lt,aJ as Ge}from"../chunks/utils.CJrG0vvE.js";import{b as Pt,p as T,i as j,o as Ut,s as Je}from"../chunks/preload-helper.7ChYRBe9.js";import{t as b,f as Ne,$ as me,r as Oe,b as Ie,s as xt,i as Ve,j as je,k as Lt,a as Le,M as Ht,C as Yt}from"../chunks/Modal.Ir7Mazj4.js";function Bt(t,e,a){B&&et();var r=t,n=yt,o,l=_t()?ht:Et;tt(()=>{l(n,n=e())&&(o&&at(o),o=xe(()=>a(r)))}),B&&(r=re)}function ce(t,e){return e}function Qt(t,e,a,r){for(var n=[],o=e.length,l=0;l<o;l++)At(e[l].e,n,!0);var v=o>0&&n.length===0&&a!==null;if(v){var h=a.parentNode;Rt(h),h.append(a),r.clear(),X(t,e[0].prev,e[o-1].next)}St(n,()=>{for(var c=0;c<o;c++){var i=e[c];v||(r.delete(i.k),X(t,i.prev,i.next)),Tt(i.e,!v)}})}function ve(t,e,a,r,n,o=null){var l=t,v={flags:e,items:new Map,first:null};{var h=t;l=B?Se(gt(h)):h.appendChild(bt())}B&&et();var c=null,i=!1;tt(()=>{var _=a(),f=pt(_)?_:_==null?[]:rt(_),u=f.length;if(i&&u===0)return;i=u===0;let E=!1;if(B){var g=l.data===Mt;g!==(u===0)&&(l=Fe(),Se(l),Te(!1),E=!0)}if(B){for(var M=null,d,m=0;m<u;m++){if(re.nodeType===8&&re.data===Nt){l=re,E=!0,Te(!1);break}var $=f[m],w=r($,m);d=ot(re,v,M,null,$,w,m,n,e),v.items.set(w,d),M=d}u>0&&Se(Fe())}if(!B){var O=Ot;qt(f,v,l,n,e,(O.f&ye)!==0,r)}o!==null&&(u===0?c?nt(c):c=xe(()=>o(l)):c!==null&&at(c,()=>{c=null})),E&&Te(!0),a()}),B&&(l=re)}function qt(t,e,a,r,n,o,l){var v=t.length,h=e.items,c=e.first,i=c,_,f=null,u=[],E=[],g,M,d,m;for(m=0;m<v;m+=1){if(g=t[m],M=l(g,m),d=h.get(M),d===void 0){var $=i?i.e.nodes_start:a;f=ot($,e,f,f===null?e.first:f.next,g,M,m,r,n),h.set(M,f),u=[],E=[],i=f.next;continue}if(Ft(d,g,m),d.e.f&ye&&nt(d.e),d!==i){if(_!==void 0&&_.has(d)){if(u.length<E.length){var w=E[0],O;f=w.prev;var q=u[0],k=u[u.length-1];for(O=0;O<u.length;O+=1)Xe(u[O],w,a);for(O=0;O<E.length;O+=1)_.delete(E[O]);X(e,q.prev,k.next),X(e,f,q),X(e,k,w),i=w,f=k,m-=1,u=[],E=[]}else _.delete(d),Xe(d,i,a),X(e,d.prev,d.next),X(e,d,f===null?e.first:f.next),X(e,f,d),f=d;continue}for(u=[],E=[];i!==null&&i.k!==M;)(o||!(i.e.f&ye))&&(_??(_=new Set)).add(i),E.push(i),i=i.next;if(i===null)continue;d=i}u.push(d),f=d,i=d.next}if(i!==null||_!==void 0){for(var K=_===void 0?[]:rt(_);i!==null;)(o||!(i.e.f&ye))&&K.push(i),i=i.next;var G=K.length;if(G>0){var J=v===0?a:null;Qt(e,K,J,h)}}We.first=e.first&&e.first.e,We.last=f&&f.e}function Ft(t,e,a,r){mt(t.v,e),t.i=a}function ot(t,e,a,r,n,o,l,v,h){var c=(h&wt)!==0,i=(h&$t)===0,_=c?i?It(n):Ke(n):n,f=h&Dt?Ke(l):l,u={i:f,v:_,k:o,a:null,e:null,prev:a,next:r};try{return u.e=xe(()=>v(t,_,f),B),u.e.prev=a&&a.e,u.e.next=r&&r.e,a===null?e.first=u:(a.next=u,a.e.next=u.e),r!==null&&(r.prev=u,r.e.prev=u.e),u}finally{}}function Xe(t,e,a){for(var r=t.next?t.next.e.nodes_start:a,n=e?e.e.nodes_start:a,o=t.e.nodes_start;o!==r;){var l=kt(o);n.before(o),o=l}}function X(t,e,a){e===null?t.first=a:(e.next=a,e.e.next=a&&a.e),a!==null&&(a.prev=e,a.e.prev=e&&e.e)}function Wt(t,e){var a=t.__className,r=Kt(e);B&&t.className===r?t.__className=r:(a!==r||B&&t.className!==r)&&(e==null?t.removeAttribute("class"):t.className=r,t.__className=r)}function Kt(t){return t??""}function Gt(t,e,a){if(a){if(t.classList.contains(e))return;t.classList.add(e)}else{if(!t.classList.contains(e))return;t.classList.remove(e)}}function it(t,e,a){if(t.multiple)return jt(t,e);for(var r of t.options){var n=fe(r);if(Pt(n,e)){r.selected=!0;return}}(!a||e!==void 0)&&(t.selectedIndex=-1)}function Jt(t,e){st(()=>{var a=new MutationObserver(()=>{var r=t.__value;it(t,r)});return a.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{a.disconnect()}})}function Vt(t,e,a=e){var r=!0;ft(t,"change",n=>{var o=n?"[selected]":":checked",l;if(t.multiple)l=[].map.call(t.querySelectorAll(o),fe);else{var v=t.querySelector(o)??t.querySelector("option:not([disabled])");l=v&&fe(v)}a(l)}),st(()=>{var n=e();if(it(t,n,r),r&&n===void 0){var o=t.querySelector(":checked");o!==null&&(n=fe(o),a(n))}t.__value=n,r=!1}),Jt(t)}function jt(t,e){for(var a of t.options)a.selected=~e.indexOf(fe(a))}function fe(t){return"__value"in t?t.__value:t.value}const Xt=[b.JANUARY,b.FEBRUARY,b.MARCH,b.APRIL,b.MAY,b.JUNE,b.JULY,b.AUGUST,b.SEPTEMBER,b.OCTOBER,b.NOVEMBER,b.DECEMBER],ne=[b.SHORT_SUNDAY,b.SHORT_MONDAY,b.SHORT_TUESDAY,b.SHORT_WEDNESDAY,b.SHORT_THURSDAY,b.SHORT_FRIDAY,b.SHORT_SATURDAY],ge=new Date(2024,0,1);function ut(t,e){return new Date(e,t+1,0).getDate()}function ct(t,e){return new Date(e,t,1).getDay()}function vt(t,e){return(t-e+ne.length)%ne.length}function zt(t,e,a=0){const r=vt(ct(t,e),a),n=ut(t,e);return Math.ceil((r+n)/7)}function Zt(t,e,a,r,n=0){return a+r*ne.length-vt(ct(t,e),n)+1}function ea(t,e){return Math.floor((t.getTime()-e.getTime())/(1e3*60*60*24))}function be(t,e){return(ea(t,e)%365+365)%365}var R=(t=>(t.GEMS="GEMS",t.KAMAS="KAMAS",t.EQUIPMENT="EQUIPMENT",t.CHEST="CHEST",t.WAKFU="WAKFU",t.RUNES="RUNES",t))(R||{}),ta=A('<span class="text svelte-1mvyt92"> </span>'),aa=A('<section class="tooltip svelte-1mvyt92"><!> <!></section>');function ra(t,e){let a=T(e,"title",8,void 0);var r=aa(),n=S(r);Ne(n,e,"default",{});var o=C(n,2);{var l=v=>{var h=ta(),c=S(h,!0);p(h),Q(()=>z(c,a())),y(v,h)};j(o,v=>{a()&&v(l)})}p(r),y(t,r)}var na=A("<button><div> </div></button>");function sa(t,e){le(e,!1);const a=pe(),r=()=>Me(me,"$_",a);let n=T(e,"currentDate",8),o=T(e,"dayOfMonth",8),l=T(e,"reward",8,void 0),v=T(e,"onclick",8);const h=new Date;function c(){if(l())return l().type===R.EQUIPMENT?l().rarety.toLowerCase():l().type.toLowerCase()}function i(){if(l()){let f=`${l().amount}× ${r()(l().type)}`;switch(l().type){case R.RUNES:case R.CHEST:f+=` ${r()(l().equipment)}`;break;case R.EQUIPMENT:f=`${l().amount}× ${r()(l().item)} ${r()(l().rarety)}`;break}return f}}se();var _=I(i);ra(t,{get title(){return s(_)},children:(f,u)=>{var E=na();const g=I(()=>`${c()??""} svelte-endvbj`);E.__click=function(...$){var w;(w=v())==null||w.apply(this,$)};const M=I(()=>n().toDateString()===h.toDateString());var d=S(E),m=S(d,!0);p(d),p(E),Q(()=>{Wt(E,s(g)),E.disabled=n()>h,Gt(E,"today",s(M)),z(m,o())}),y(f,E)},$$slots:{default:!0}}),oe()}Ue(["click"]);function la(t,e){le(e,!1);const a=pe(),r=()=>Me(me,"$_",a);let n=T(e,"key",8);se(),we();var o=De();Q(()=>z(o,r()(n()))),y(t,o),oe()}var oa=A("<th><!></th>"),ia=A("<td><!></td>"),ua=A("<tr></tr>"),ca=A("<table><thead><tr></tr></thead><tbody></tbody></table>");function va(t,e){le(e,!1);let a=T(e,"year",8),r=T(e,"month",8),n=T(e,"onselectday",8),o=T(e,"calendar",8),l=T(e,"weekOffset",8,1);const v=ne.length;function h(u){let E=be(u,ge);return o()[E]}se();var c=ca(),i=S(c),_=S(i);ve(_,5,()=>({length:v}),ce,(u,E,g)=>{var M=oa(),d=S(M);la(d,{get key(){return ne[(g+l())%v]}}),p(M),y(u,M)}),p(_),p(i);var f=C(i);ve(f,5,()=>({length:zt(r(),a(),l())}),ce,(u,E,g)=>{var M=ua();const d=I(()=>ut(r(),a()));ve(M,5,()=>ne,ce,($,w,O)=>{var q=ia();const k=I(()=>Zt(r(),a(),O,g,l()));var K=S(q);{var G=J=>{const U=I(()=>new Date(a(),r(),s(k))),x=I(()=>h(s(U)));sa(J,{get currentDate(){return s(U)},get dayOfMonth(){return s(k)},get reward(){return s(x)},onclick:()=>n()(s(U))})};j(K,J=>{s(k)>0&&s(k)<=s(d)&&J(G)})}p(q),y($,q)}),p(M),y(u,M)}),p(f),p(c),y(t,c),oe()}var $e=(t=>(t.COMPANIONS="COMPANIONS",t.SPELLS="SPELLS",t.EQUIPMENTS="EQUIPMENTS",t))($e||{}),ke=(t=>(t.RING="RING",t.ARMBAND="ARMBAND",t.COMPANION="COMPANION",t))(ke||{}),Ce=(t=>(t.COMMON="COMMON",t.RARE="RARE",t.KROSMIC="KROSMIC",t.INFINITE="INFINITE",t))(Ce||{}),fa=A("<span> </span>"),da=A('<section class="svelte-1j4lmfo"><!> <!></section>');function Pe(t,e){let a=T(e,"title",8,void 0);var r=da(),n=S(r);{var o=v=>{var h=fa(),c=S(h);p(h),Q(()=>z(c,`${a()??""}:`)),y(v,h)};j(n,v=>{a()&&v(o)})}var l=C(n,2);Ne(l,e,"default",{}),p(r),y(t,r)}var _a=A("<option> </option>"),ha=A("<select></select>");function Ee(t,e){le(e,!1);const a=pe(),r=()=>Me(me,"$_",a);let n=T(e,"title",8,void 0),o=T(e,"values",24,()=>[]),l=T(e,"value",12);se(),Pe(t,{get title(){return n()},children:(v,h)=>{var c=ha();Q(()=>{l(),Ct(()=>{o(),r()})}),ve(c,5,o,ce,(i,_)=>{var f=_a(),u={},E=S(f,!0);Q(()=>z(E,r()(s(_)))),p(f),Q(()=>{u!==(u=s(_))&&(f.value=(f.__value=s(_))==null?"":s(_))}),y(i,f)}),p(c),Vt(c,l),y(v,c)},$$slots:{default:!0}}),oe()}function Ea(t){return Object.values(t).filter(e=>typeof e!="number")}var ya=A("<!> <!>",1),ga=A('<input type="number" min="100" max="250" step="50">'),ba=A('<input type="number" min="1" max="5000">'),pa=A('<input type="text">'),Ma=(t,e)=>e()(),Na=A('<button class="delete material-icon svelte-tu6hhq">delete</button>'),ma=A('<section class="svelte-tu6hhq"><!> <!> <!> <!> <div class="controls svelte-tu6hhq"><button class="secondary svelte-tu6hhq"> </button> <button class="primary svelte-tu6hhq"> </button> <!></div></section>');function Aa(t,e){var de,_e,he,Re,Ye,Be,Qe;le(e,!1);const a=pe(),r=()=>Me(me,"$_",a);let n=T(e,"oncancel",8),o=T(e,"onsave",8),l=T(e,"ondelete",8,void 0),v=T(e,"reward",8,void 0),h=T(e,"date",8),c=W(((de=v())==null?void 0:de.type)??R.EQUIPMENT),i=W(((_e=v())==null?void 0:_e.type)===R.EQUIPMENT?v().rarety:Ce.COMMON),_=W(((he=v())==null?void 0:he.type)===R.RUNES||((Re=v())==null?void 0:Re.type)===R.CHEST?v().equipment:$e.EQUIPMENTS),f=W(((Ye=v())==null?void 0:Ye.type)===R.EQUIPMENT?v().item:ke.RING),u=W(((Be=v())==null?void 0:Be.amount)??1),E=W(((Qe=v())==null?void 0:Qe.type)===R.EQUIPMENT?v().description:void 0);function g(){let N;const D={cycle_index:be(h(),ge),amount:s(u)};switch(s(c)){case R.GEMS:N={...D,type:s(c),amount:s(u)};break;case R.EQUIPMENT:N={...D,type:s(c),rarety:s(i),item:s(f),description:s(E)};break;case R.CHEST:N={...D,type:s(c),equipment:s(_)};break;case R.RUNES:N={...D,type:s(c),equipment:s(_)};break;case R.KAMAS:case R.WAKFU:N={...D,type:s(c)};break}o()(N)}se();var M=ma(),d=S(M),m=I(()=>r()(b.REWARD_LABEL_TYPE)),$=I(()=>Ea(R));Ee(d,{get title(){return s(m)},get values(){return s($)},get value(){return s(c)},set value(N){P(c,N)},$$legacy:!0});var w=C(d,2);{var O=N=>{var D=ya(),H=ue(D),V=I(()=>r()(b.REWARD_LABEL_RARITY)),L=I(()=>Object.keys(Ce));Ee(H,{get title(){return s(V)},get values(){return s(L)},get value(){return s(i)},set value(te){P(i,te)},$$legacy:!0});var ee=C(H,2),F=I(()=>r()(b.REWARD_LABEL_ITEM_TYPE)),Y=I(()=>Object.keys(ke));Ee(ee,{get title(){return s(F)},get values(){return s(Y)},get value(){return s(f)},set value(te){P(f,te)},$$legacy:!0}),y(N,D)},q=N=>{var D=qe(),H=ue(D);{var V=L=>{var ee=I(()=>r()(b.REWARD_LABEL_EQUIPMENT_TYPE)),F=I(()=>Object.keys($e));Ee(L,{get title(){return s(ee)},get values(){return s(F)},get value(){return s(_)},set value(Y){P(_,Y)},$$legacy:!0})};j(H,L=>{(s(c)===R.CHEST||s(c)===R.RUNES)&&L(V)},!0)}y(N,D)};j(w,N=>{s(c)===R.EQUIPMENT?N(O):N(q,!1)})}var k=C(w,2),K=I(()=>r()(b.REWARD_LABEL_AMOUNT));Pe(k,{get title(){return s(K)},children:(N,D)=>{var H=qe(),V=ue(H);{var L=F=>{var Y=ga();Oe(Y),Ie(Y,()=>s(u),te=>P(u,te)),y(F,Y)},ee=F=>{var Y=ba();Oe(Y),Ie(Y,()=>s(u),te=>P(u,te)),y(F,Y)};j(V,F=>{s(c)===R.GEMS?F(L):F(ee,!1)})}y(N,H)},$$slots:{default:!0}});var G=C(k,2);{var J=N=>{var D=I(()=>r()(b.REWARD_LABEL_EQUIPMENT_MORE));Pe(N,{get title(){return s(D)},children:(H,V)=>{var L=pa();Oe(L),Q(()=>xt(L,"placeholder",r()(b.EQUIPMENT_MORE_PLACEHOLDER))),Ie(L,()=>s(E),ee=>P(E,ee)),y(H,L)},$$slots:{default:!0}})};j(G,N=>{s(c)===R.EQUIPMENT&&N(J)})}var U=C(G,2),x=S(U);x.__click=[Ma,n];var Z=S(x,!0);Q(()=>z(Z,r()(b.CANCEL))),p(x);var ae=C(x,2);ae.__click=g;var He=S(ae,!0);Q(()=>z(He,r()(b.SAVE))),p(ae);var ie=C(ae,2);{var Ae=N=>{var D=Na();D.__click=function(...H){var V;(V=l())==null||V.apply(this,H)},y(N,D)};j(ie,N=>{l()&&N(Ae)})}p(U),p(M),y(t,M),oe()}Ue(["click"]);var Ra=A('<section class="svelte-1p5vij8"><!></section>');function ze(t,e){let a=T(e,"leftToRight",8,!0);const r=1e3;var n=Ra(),o=S(n);Ne(o,e,"default",{}),p(n),Ve(1,n,()=>je,()=>({delay:250,x:r*(a()?-1:1)})),Ve(2,n,()=>je,()=>({duration:250,x:r*(a()?1:-1)})),y(t,n)}var Sa=A('<section class="material-icon"><!></section>');function Ze(t,e){var a=Sa(),r=S(a);Ne(r,e,"default",{}),p(a),y(t,a)}var Ta=A('<button class="svelte-4xatps">Se déconnecter</button>');function Oa(t){var e=Ta();dt("click",e,function(...a){var r;(r=Lt)==null||r.apply(this,a)}),y(t,e)}async function Ia(t){const e=await Le.from("T_Reward").upsert(t).select();if(e.error)throw e.error;return e.data[0]}async function Da(t){const e=await Le.from("T_Reward").delete().match({cycle_index:t}).select();if(e.error)throw e.error;return e.data[0]}async function wa(){const t=await Le.from("T_Reward").select();if(t.error)throw t.error;const e=t.data;console.log(e);const a=[];for(const r of e){const n=r;a[n.cycle_index]=n}return a}var $a=(t,e,a)=>{P(e,!0),lt(a,-1)},ka=(t,e,a)=>{P(e,!1),lt(a)},Ca=A('<div class="months svelte-oihcp3"></div>'),Pa=A('<div class="year svelte-oihcp3"><!></div>'),Ua=A('<header class="svelte-oihcp3"><button class="svelte-oihcp3"><!></button> <h2 class="svelte-oihcp3"> </h2> <button class="svelte-oihcp3"><!></button></header> <div class="calendar svelte-oihcp3"><!></div>',1),xa=A("<!> <!> <!>",1);function qa(t,e){le(e,!1);let a=W([]),r=W(new Date().getFullYear()),n=W(),o=W(!0);function l(g){P(n,g)}function v(g){if(!s(n))throw new Error("No selected day");Ge(a,s(a)[be(s(n),ge)]=g),P(n,void 0),Ia(g)}function h(){if(!s(n))throw new Error("No selected day");return be(s(n),ge)}function c(){if(!s(n))throw new Error("No selected day");const g=h();Da(g),Ge(a,s(a)[g]=void 0),P(n,void 0)}Ut(async()=>{P(a,await wa())}),se();var i=xa(),_=ue(i);{var f=g=>{var M=I(()=>s(n).toDateString());Ht(g,{get title(){return s(M)},onclose:()=>{P(n,void 0)},children:(d,m)=>{Aa(d,Je({get reward(){return s(a)[h()]},oncancel:()=>{P(n,void 0)}},()=>({onsave:v,date:s(n),ondelete:c})))},$$slots:{default:!0}})};j(_,g=>{s(n)&&g(f)})}var u=C(_,2);ze(u,{children:(g,M)=>{var d=Ua(),m=ue(d),$=S(m);$.__click=[$a,o,r];var w=S($);Ze(w,{children:(U,x)=>{we();var Z=De("arrow_back_ios");y(U,Z)},$$slots:{default:!0}}),p($);var O=C($,2),q=S(O,!0);p(O);var k=C(O,2);k.__click=[ka,o,r];var K=S(k);Ze(K,{children:(U,x)=>{we();var Z=De("arrow_forward_ios");y(U,Z)},$$slots:{default:!0}}),p(k),p(m);var G=C(m,2),J=S(G);Bt(J,()=>s(r),U=>{var x=Pa(),Z=S(x);ze(Z,{get leftToRight(){return s(o)},children:(ae,He)=>{var ie=Ca();ve(ie,5,()=>Xt,ce,(Ae,de,_e)=>{Yt(Ae,{get i18nTitleKey(){return s(de)},children:(he,Re)=>{va(he,Je(()=>({month:_e,year:s(r),onselectday:l,calendar:s(a)})))},$$slots:{default:!0}})}),p(ie),y(ae,ie)},$$slots:{default:!0}}),p(x),y(U,x)}),p(G),Q(()=>z(q,s(r))),y(g,d)},$$slots:{default:!0}});var E=C(u,2);Oa(E),y(t,i),oe()}Ue(["click"]);export{qa as component};
